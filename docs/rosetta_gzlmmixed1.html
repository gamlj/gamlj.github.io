<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="generator" content="pandoc" />

        <meta name="author" content="Marcello Gallucci" />
    
    
    <title>Rosetta store: Generalized Mixed</title>

        <script src="site_libs/header-attrs-2.28/header-attrs.js"></script>
        <script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link href="site_libs/bootstrap-3.3.7/css/bootstrap.min.css" rel="stylesheet" />
        <script src="site_libs/bootstrap-3.3.7/js/bootstrap.min.js"></script>
        <script src="site_libs/navigation-1.1/tabsets.js"></script>
        <link href="site_libs/magnific-popup-1.1.0/magnific-popup.css" rel="stylesheet" />
        <script src="site_libs/magnific-popup-1.1.0/jquery.magnific-popup.min.js"></script>
        <link href="site_libs/readthedown-0.1/readthedown.css" rel="stylesheet" />
        <link href="site_libs/readthedown-0.1/readthedown_fonts_embed.css" rel="stylesheet" />
        <script src="site_libs/readthedown-0.1/readthedown.js"></script>
        <script>
        $(document).ready(function () {

            if ($(".root")[0]){
              return
            };
            $('.navbar-toggle').show();
            $('.navbar').css('display', 'none');
            $('#sidebar > h2 ').append("<a id='navbut' href=''><i class='fa fa-bars'></i></a>");
            $('#navbut').on( "click", function(e) {
                       $('.navbar').toggle();
                       e.preventDefault();
               } );
              $('.navbar-toggle').on('click', function(e) {
                       $('.navbar').toggle();
                       e.preventDefault();
              });       
            $(window).scroll(function (event) {
                $('.navbar').css('display', 'none');
            });       
        });
        </script>
        <!-- Google tag (gtag.js) -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-KM7X6HK5HM"></script>
        <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());

          gtag('config', 'G-KM7X6HK5HM');
        </script>
    
    
        <style type="text/css">code{white-space: pre;}</style>
    <style type="text/css">
      pre > code.sourceCode { white-space: pre; position: relative; }
      pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
      pre > code.sourceCode > span:empty { height: 1.2em; }
      .sourceCode { overflow: visible; }
      code.sourceCode > span { color: inherit; text-decoration: inherit; }
      div.sourceCode { margin: 1em 0; }
      pre.sourceCode { margin: 0; }
      @media screen {
      div.sourceCode { overflow: auto; }
      }
      @media print {
      pre > code.sourceCode { white-space: pre-wrap; }
      pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
      }
      pre.numberSource code
        { counter-reset: source-line 0; }
      pre.numberSource code > span
        { position: relative; left: -4em; counter-increment: source-line; }
      pre.numberSource code > span > a:first-child::before
        { content: counter(source-line);
          position: relative; left: -1em; text-align: right; vertical-align: baseline;
          border: none; display: inline-block;
          -webkit-touch-callout: none; -webkit-user-select: none;
          -khtml-user-select: none; -moz-user-select: none;
          -ms-user-select: none; user-select: none;
          padding: 0 4px; width: 4em;
          background-color: #ffffff;
          color: #a0a0a0;
        }
      pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
      div.sourceCode
        { color: #1f1c1b; background-color: #ffffff; }
      @media screen {
      pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
      }
      code span { color: #1f1c1b; } /* Normal */
      code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
      code span.an { color: #ca60ca; } /* Annotation */
      code span.at { color: #0057ae; } /* Attribute */
      code span.bn { color: #b08000; } /* BaseN */
      code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
      code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
      code span.ch { color: #924c9d; } /* Char */
      code span.cn { color: #aa5500; } /* Constant */
      code span.co { color: #898887; } /* Comment */
      code span.cv { color: #0095ff; } /* CommentVar */
      code span.do { color: #607880; } /* Documentation */
      code span.dt { color: #0057ae; } /* DataType */
      code span.dv { color: #b08000; } /* DecVal */
      code span.er { color: #bf0303; text-decoration: underline; } /* Error */
      code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
      code span.fl { color: #b08000; } /* Float */
      code span.fu { color: #644a9b; } /* Function */
      code span.im { color: #ff5500; } /* Import */
      code span.in { color: #b08000; } /* Information */
      code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
      code span.op { color: #1f1c1b; } /* Operator */
      code span.ot { color: #006e28; } /* Other */
      code span.pp { color: #006e28; } /* Preprocessor */
      code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
      code span.sc { color: #3daee9; } /* SpecialChar */
      code span.ss { color: #ff5500; } /* SpecialString */
      code span.st { color: #bf0303; } /* String */
      code span.va { color: #0057ae; } /* Variable */
      code span.vs { color: #bf0303; } /* VerbatimString */
      code span.wa { color: #bf0303; } /* Warning */
    </style>
    
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css" type="text/css" />
        <link rel="stylesheet" href="mcdocs.css" type="text/css" />
        <link rel="stylesheet" href="down.css" type="text/css" />
    
    <!-- tabsets -->
    <script>
      $(document).ready(function () {
	  window.buildTabsets("toc");
      });
      $(document).ready(function () {
	  $('.tabset-dropdown > .nav-tabs > li').click(function () {
	      $(this).parent().toggleClass('nav-tabs-open')
	  });
      });
    </script>

    <!-- code folding -->
    
    <!-- code download -->
    
    <!-- tabsets dropdown -->

    <style type="text/css">
      .tabset-dropdown > .nav-tabs {
	  display: inline-table;
	  max-height: 500px;
	  min-height: 44px;
	  overflow-y: auto;
	  background: white;
	  border: 1px solid #ddd;
	  border-radius: 4px;
      }
      
      .tabset-dropdown > .nav-tabs > li.active:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
	  content: "&#xe258;";
	  border: none;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .tabset-dropdown > .nav-tabs > li.active {
	  display: block;
      }

      .tabset-dropdown > .nav-tabs > li.active a {
  	  padding: 0 15px !important;
      }

      .tabset-dropdown > .nav-tabs > li > a,
      .tabset-dropdown > .nav-tabs > li > a:focus,
      .tabset-dropdown > .nav-tabs > li > a:hover {
	  border: none;
	  display: inline-block;
	  border-radius: 4px;
	  background-color: transparent;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li {
	  display: block;
	  float: none;
      }
      
      .tabset-dropdown > .nav-tabs > li {
	  display: none;
	  margin-left: 0 !important;
      }
    </style>
    
</head>

<body class="preload">

   	
         <!-- readthedown start -->   
   <div id="content" data-toggle="wy-nav-shift">
     <nav id="nav-top" role="navigation" aria-label="top navigation">
       <a role="button" href="#" data-toggle="wy-nav-top"><span class="glyphicon glyphicon-menu-hamburger"></span></a>
     </nav>
         
   
      
      <div class="navbar navbar-default  navbar-fixed-top" role="navigation">
        <div class="container">
          <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="index.html">GAMLj</a>
          </div>
          <div id="navbar" class="navbar-collapse collapse">
            <ul class="nav navbar-nav">
              <li>
        <a href="glm.html">GLM</a>
      </li>
      <li>
        <a href="mixed.html">Mixed</a>
      </li>
      <li>
        <a href="gzlm.html">Generalized</a>
      </li>
      <li>
        <a href="gzlmmixed.html">Generalized Mixed</a>
      </li>
      <li>
        <a href="examples.html">Examples</a>
      </li>
      <li>
        <a href="release_notes.html">Release notes</a>
      </li>
      <li>
        <a href="vignettes.html">GAMLj in R</a>
      </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
              <li>
        <a href="https://github.com/gamlj/gamlj">View on Github</a>
      </li>
            </ul>
          </div><!--/.nav-collapse -->
        </div><!--/.container -->
      </div><!--/.navbar -->
        
      <h1 class="title">Rosetta store: Generalized Mixed</h1>
      
         <!-- readthedown authors -->
   <div id="sidebar">
    <h2><a href="#content">Rosetta store: Generalized Mixed</a></h2>
    <div id="toc">
      <ul>
      <li><a href="#the-research-design"
      id="toc-the-research-design">The research design</a></li>
      <li><a href="#r" id="toc-r">R</a>
      <ul>
      <li><a href="#results" id="toc-results">Results</a></li>
      </ul></li>
      <li><a href="#gamlj" id="toc-gamlj">GAMLj</a>
      <ul>
      <li><a href="#results-1" id="toc-results-1">Results</a></li>
      <li><a href="#omnibus-tests" id="toc-omnibus-tests">Omnibus
      tests</a></li>
      </ul></li>
      <li><a href="#spss" id="toc-spss">SPSS</a>
      <ul>
      <li><a href="#results-2" id="toc-results-2">Results</a></li>
      </ul></li>
      <li><a href="#rosettas-files" id="toc-rosettas-files">Rosetta’s
      files</a></li>
      <li><a href="#comments" id="toc-comments">Comments?</a></li>
      </ul>
    </div>
    <div id="postamble" data-toggle="wy-nav-shift" class="status">
                  <p class="author"><span class="glyphicon glyphicon-user"></span> Marcello
Gallucci</p>
                      </div>
   </div>
     

   
      
   
<!-- Don't indent these lines or it will mess pre blocks indentation --> 
<div id="main">
<p><span class="keywords"> <span class="keytitle"> keywords </span>
jamovi, R, SPSS, logistic, generalized mixed, mixed models </span></p>
<div class="version">
<p>
2.0.0
</p>
</div>
<div style="clear:both">

</div>
<p><span class="draft"> Draft version, mistakes may be around
</span></p>
<p>Here you can find comparisons of results obtained in <span
class="jamovi"><a href="http://www.jamovi.org" target="_blank">jamovi</a></span>
<span class="modulename">GAMLj</span>, R, and SPSS. When not explicitly
discussed, the code of different software is written with the aim of
obtaining identical results across programs (not necessarily with the
most efficient strategy).</p>
<p>In this example we compare <span class="modulename">GAMLj</span>
results with R results obtained by IDRE on their <a
href="https://stats.idre.ucla.edu/r/dae/mixed-effects-logistic-regression/">tutorial
web page</a>, and with SPSS results.</p>
<div id="the-research-design" class="section level1">
<h1>The research design</h1>
<p>In this example, we are going to explore lung cancer remission using
a simulated dataset. A variety of outcomes were collected on patients,
who are nested within doctors, who are in turn nested within hospitals.
There are also a few doctor level variables, such as
<em>Experience</em>, that we will use in our example (<a
href="https://stats.idre.ucla.edu/r/dae/mixed-effects-logistic-regression/">IDRE</a>).
Data can be downloaded <a
href="https://stats.idre.ucla.edu/stat/data/hdp.csv">here</a></p>
</div>
<div id="r" class="section level1">
<h1>R</h1>
<p>The researcher is interested in studying the relationships between
cancer remission and both patients and doctors characteristics. The
analyst uses the R <code>glmer</code> command from the
<code>lme4 Package</code> to estimate a mixed effects logistic
regression model with <code>Il6</code>, <code>CRP</code>, and
<code>LengthofStay</code> as patient level continuous predictors,
<code>CancerStage</code> as a patient level categorical predictor (I,
II, III, or IV), <code>Experience</code> as a doctor level continuous
predictor, and a random intercept by <code>DID</code>, doctor ID.</p>
<div id="results" class="section level2">
<h2>Results</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co"># estimate the model and store results in m</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">glmer</span>(remission <span class="sc">~</span> IL6 <span class="sc">+</span> CRP <span class="sc">+</span> CancerStage <span class="sc">+</span> LengthofStay <span class="sc">+</span> Experience <span class="sc">+</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> DID), <span class="at">data =</span> hdp, <span class="at">family =</span> binomial, <span class="at">control =</span> <span class="fu">glmerControl</span>(<span class="at">optimizer =</span> <span class="st">&quot;bobyqa&quot;</span>),</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>    <span class="at">nAGQ =</span> <span class="dv">10</span>)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="co"># print the mod results without correlations among fixed effects</span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="fu">print</span>(m, <span class="at">corr =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="do">## Generalized linear mixed model fit by maximum likelihood (Adaptive</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="do">##   Gauss-Hermite Quadrature, nAGQ = 10) [glmerMod]</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="do">##  Family: binomial ( logit )</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="do">## Formula: </span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="do">## remission ~ IL6 + CRP + CancerStage + LengthofStay + Experience +  </span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="do">##     (1 | DID)</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="do">##    Data: hdp</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="do">##      AIC      BIC   logLik deviance df.resid </span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a><span class="do">##     7397     7461    -3690     7379     8516 </span></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a><span class="do">## Random effects:</span></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a><span class="do">##  Groups Name        Std.Dev.</span></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a><span class="do">##  DID    (Intercept) 2.01    </span></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a><span class="do">## Number of obs: 8525, groups: DID, 407</span></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a><span class="do">## Fixed Effects:</span></span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a><span class="do">##    (Intercept)             IL6             CRP   CancerStageII  </span></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a><span class="do">##        -2.0527         -0.0568         -0.0215         -0.4139  </span></span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a><span class="do">## CancerStageIII   CancerStageIV    LengthofStay      Experience  </span></span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a><span class="do">##        -1.0035         -2.3370         -0.1212          0.1201</span></span></code></pre></div>
<p>The analyst goes on in computing the confidence intervals of the
estimates applying the simple formula <span class="math inline">\(\theta
\pm 1.96 \cdot SE_{\theta}\)</span>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcov</span>(m)))</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="co"># table of estimates with 95% CI</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>(tab <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">Est =</span> <span class="fu">fixef</span>(m), <span class="at">LL =</span> <span class="fu">fixef</span>(m) <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> se, <span class="at">UL =</span> <span class="fu">fixef</span>(m) <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span>se))</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="do">##                     Est       LL        UL</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="do">## (Intercept)    -2.05269 -3.09435 -1.011025</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="do">## IL6            -0.05677 -0.07935 -0.034196</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="do">## CRP            -0.02148 -0.04151 -0.001455</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="do">## CancerStageII  -0.41393 -0.56243 -0.265436</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="do">## CancerStageIII -1.00346 -1.19610 -0.810828</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="do">## CancerStageIV  -2.33704 -2.64683 -2.027241</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="do">## LengthofStay   -0.12118 -0.18710 -0.055261</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="do">## Experience      0.12009  0.06628  0.173895</span></span></code></pre></div>
<p>Also the <span class="math inline">\(e^B\)</span> are computed.</p>
<pre><code>exp(tab)</code></pre>
<pre><code>
##                    Est      LL     UL
## (Intercept)    0.12839 0.04530 0.3638
## IL6            0.94481 0.92372 0.9664
## CRP            0.97875 0.95934 0.9985
## CancerStageII  0.66104 0.56982 0.7669
## CancerStageIII 0.36661 0.30237 0.4445
## CancerStageIV  0.09661 0.07088 0.1317
## LengthofStay   0.88587 0.82936 0.9462
## Experience     1.12760 1.06853 1.1899
</code></pre>
</div>
</div>
<div id="gamlj" class="section level1">
<h1>GAMLj</h1>
<p><span
class="jamovi"><a href="http://www.jamovi.org" target="_blank">jamovi</a></span>
<span class="modulename">GAMLj</span> module for
<code>Generalized mixed models</code> can be used to estimate a random
coefficient mixed model. First, it requires choose the specific model we
want to run: the <code>Logistic</code> model.</p>
<p><img src="rosetta/gzlmmixed/modelpick.png" class="img-responsive" alt=""></p>
<p>Then we set the variables in the right field depending on their role
in the model and their type.</p>
<p><img src="rosetta/gzlmmixed/variables.png" class="img-responsive" alt=""></p>
<p>Please note that we put <code>LengthOfStay</code> in covariates
because it is a continuous variable, even though <span
class="jamovi"><a href="http://www.jamovi.org" target="_blank">jamovi</a></span>
recognizes it a categorical. By putting it in <span
class="option">Covariates</span>, we implicitly ask the module to treat
it a continuous variable. The opposite holds for <code>DID</code>
(doctors ID) which <span
class="jamovi"><a href="http://www.jamovi.org" target="_blank">jamovi</a></span>
recognizes as continuous but the module treats as categorical after we
put it in the <span class="option">Clusters</span> field.</p>
<p>After the first setup, we need to specify the random effects.
Following the IDRE analysis, we specify the intercept as random
coefficient across doctors (<code>DID</code>).</p>
<p><img src="rosetta/gzlmmixed/random.png" class="img-responsive" alt=""></p>
<p>As soon as we include a random effect, the model is estimated</p>
<div id="results-1" class="section level2">
<h2>Results</h2>
<p>Let’s us first focus on the fixed parameters estimates, the B
coefficients.</p>
<p><img src="rosetta/gzlmmixed/results_estimates.png" class="img-responsive" alt=""></p>
<p>For the predictors coefficients we have substantially the same
results as in R, apart from rounding. For the intercept we have
different results. The reason is the different default coding of the
variables in <span class="modulename">GAMLj</span> and in R. In R
default, factors are coded with the <em>dummy coding scheme</em>, that
is</p>
<pre><code>&gt; contrasts(hdp$CancerStage)
    II III IV
I    0   0  0
II   1   0  0
III  0   1  0
IV   0   0  1</code></pre>
<p>and continuous independent variables are not scaled. In <span
class="modulename">GAMLj</span> the default coding system for
categorical variable is `<span class="option">simple</span>.</p>
<p><img src="rosetta/gzlmmixed/coding.png" class="img-responsive" alt=""></p>
<p>which results in a centered contrast.</p>
<p><img src="rosetta/gzlmmixed/results_coding.png" class="img-responsive" alt=""></p>
<p>Continuous variables are centered by default.</p>
<p>Thus, in GAMLj the intercept is the expected mean of the
(transformed) dependent variable, whereas in R is the expected mean of
the (transformed) dependent variable for all continuous independent
variables equal to zero and the group scoring all zeros in the
categorical variable.</p>
<p>Also the exp(B) and their confidence intervals are equivalent in the
two analyses, apart from rounding.</p>
<p>As regards the random coefficients variance, <code>lme4::glmer</code>
produced a <code>SD</code> of 2.01, thus a variance of 4.0401, which is
noticeably different from the GAMLj results.</p>
<p><img src="rosetta/gzlmmixed/results_random.png" class="img-responsive" alt=""></p>
<p>The reason of this difference is in the precision of the estimation.
<code>lme4::glmer</code> estimates the model parameters evaluating the
adaptive Gauss-Hermite approximation to the log-likelihood. How good the
approximation will be is decided by the option <code>nAGQ</code>,
specified in the <code>glmer</code> command above. The higher the
number, the better the approximation, with a penalty in speed. Also
GAMLj lets the user decide the precision level of the estimation with
the equivalent parameter <code>precision/speed</code> in the
<code>Options</code> tab.</p>
<p><img src="rosetta/gzlmmixed/precision.png" class="img-responsive" alt=""></p>
<p>GAMLj default is a value of 1 (fast but not highly precise
estimation). If we set the <code>precision/speed</code> parameter to 10,
we obtain exactly the same results obtained in R. The estimation will
take some time, however.</p>
<p><img src="rosetta/gzlmmixed/results_precision.png" class="img-responsive" alt=""></p>
</div>
<div id="omnibus-tests" class="section level2">
<h2>Omnibus tests</h2>
<p>The IDRE analysis did not report the omnibus tests. In R, one can
obtain the omnibus tests employing the <code>car::Anova</code> command.
The command lets us specify what Type of analysis to do. We can ask of
the Type III analysis and we get the Chi-square tests.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="fu">Anova</span>(mod,<span class="at">type=</span><span class="dv">3</span>)</span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>Analysis of Deviance <span class="fu">Table</span> (Type III Wald chisquare tests)</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>Response<span class="sc">:</span> remission</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>               Chisq Df <span class="fu">Pr</span>(<span class="sc">&gt;</span>Chisq)    </span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>(Intercept)   <span class="fl">14.918</span>  <span class="dv">1</span>  <span class="fl">0.0001123</span> <span class="sc">**</span><span class="er">*</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>IL6           <span class="fl">24.293</span>  <span class="dv">1</span>  <span class="fl">8.273e-07</span> <span class="sc">**</span><span class="er">*</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>CRP            <span class="fl">4.420</span>  <span class="dv">1</span>  <span class="fl">0.0355197</span> <span class="sc">*</span>  </span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>CancerStage  <span class="fl">256.523</span>  <span class="dv">3</span>  <span class="sc">&lt;</span> <span class="fl">2.2e-16</span> <span class="sc">**</span><span class="er">*</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>LengthofStay  <span class="fl">12.982</span>  <span class="dv">1</span>  <span class="fl">0.0003145</span> <span class="sc">**</span><span class="er">*</span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a>Experience    <span class="fl">19.135</span>  <span class="dv">1</span>  <span class="fl">1.218e-05</span> <span class="sc">**</span><span class="er">*</span></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="sc">---</span></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a>Signif. codes<span class="sc">:</span>  <span class="dv">0</span> ‘<span class="sc">**</span><span class="er">*</span>’ <span class="fl">0.001</span> ‘<span class="sc">**</span>’ <span class="fl">0.01</span> ‘<span class="sc">*</span>’ <span class="fl">0.05</span> ‘.’ <span class="fl">0.1</span> ‘ ’ <span class="dv">1</span></span></code></pre></div>
<p><img src="rosetta/gzlmmixed/results_chi.png" class="img-responsive" alt=""></p>
<p>Compared with GAMLj results, there’s substantial agreement even
though the figures are not the same, apart from rounding. The reason is
that the estimation of the deviance of the model, on which the omnibus
tests are based, may be slightly influenced by the scale of the
variables. It is well-known that in the general linear model
(i.e. regression), the linear coefficients are invariant to linear
scaling of the independent variables. That is, if you have centered or
not centered the variables, the B’s are the same (when no interaction is
present in the model). In generalized mixed models, the scale may
slightly influence the estimation, yielding different results for
re-scaled variables.</p>
<p>Thus, the small difference in the omnibus tests obtained with R and
with GAMLj are due to the fact that in the R analysis the variables are
not re-scaled, while in GAMLj they are centered. In fact, if we do not
center the variables in GAMLj, results become identical to the R
results.</p>
<p><img src="rosetta/gzlmmixed/results_chi2.png" class="img-responsive" alt=""></p>
<p>Notice, however, that the conclusions of the analyses are equivalent
no matter the scale of the variables.</p>
</div>
</div>
<div id="spss" class="section level1">
<h1>SPSS</h1>
<p>In SPSS we can run a logistic mixed models with
<code>Generalized mixed models</code> menu. However, from within the
<code>Generalized mixed models</code> module one cannot specify whether
a variable is a continuous or categorical one, so we have to define
variables types in the <code>Variable view</code> tab of the SPSS
spreadsheet window.</p>
<p><img src="rosetta/gzlmmixed/spss_scale.png" class="img-responsive" alt=""></p>
<p>We want to be sure that <code>LengthOfStay</code>, <code>IL6</code>,
<code>CRP</code> and <code>Experience</code> are set as
<code>Scale</code> in the <code>measure</code> column, whereas
<code>DID</code> and <code>CancerStage</code> should be
<code>Nominal</code>.</p>
<p>Then we can go to the mixed models menu.</p>
<p><img src="rosetta/gzlmmixed/spss_menu.png" class="img-responsive" alt=""></p>
<p>First, we should specify the cluster variable, by dragging
<code>DID</code> into the <code>Subject</code> field, on the right, in
the <code>Canvas</code> panel.</p>
<p><img src="rosetta/gzlmmixed/spss_cluster.png" class="img-responsive" alt=""></p>
<p>Then we can move to the <code>Fields &amp; Effects</code> tab and
specify the model type (<code>Binary logistic regression</code>) and the
dependent variable (<code>remission</code>).</p>
<p><img src="rosetta/gzlmmixed/spss_dep.png" class="img-responsive" alt=""></p>
<p>On the <code>Select an item</code> field we can then move to
<code>Fixed Effects</code>, and set the independent variables.</p>
<p><img src="rosetta/gzlmmixed/spss_fixed.png" class="img-responsive" alt=""></p>
<p>The random intercept can be specified in the
<code>Random Effects</code> tab.</p>
<p><img src="rosetta/gzlmmixed/spss_random.png" class="img-responsive" alt=""></p>
<p>Here we need to flag the <code>Include intercept</code> option and
select <code>DID</code> from the menu <code>Subject combination</code>.
This means <em>allow intercepts to vary across DID</em>.</p>
<p>We can then run the analysis.</p>
<div id="results-2" class="section level2">
<h2>Results</h2>
<p><img src="rosetta/gzlmmixed/results_spss_coefs.png" class="img-responsive" alt=""></p>
<p>As regards the fixed effects coefficients, we notice that the
continuous predictors show B’s that are equivalent to R and <span
class="jamovi"><a href="http://www.jamovi.org" target="_blank">jamovi</a></span>
estimates, but with opposite sign. The intercept and the categorical
predictor are clearly very differ. Those differences are due to way SPSS
picks the reference level of the dummy coding for categorical variables.
In R and <span
class="jamovi"><a href="http://www.jamovi.org" target="_blank">jamovi</a></span>,
the reference level is the first level in the standard ordering of the
variable levels (such as the cardinal order or the alphabetical one).
SPSS picks the last group! Thus, here we are predicting the probability
of <em>not remission</em>, that is <code>remission=0</code>, because
SPSS sets <code>remission=1</code> as the reference level. That explains
the opposite sign. For the categorical independent variable
<code>CancerStage</code>, SPSS picks the group
<code>CancerStage=IV</code> as reference group, whereas GAMLj and R pick
<code>CancerStage=I</code>. That explains the differences in the
parameters.</p>
<p>In SPSS generalized mixed models we can change the reference level in
the <code>Build Options</code> tab, selecting <code>Descending</code> in
the <code>Sorting Order</code> options.</p>
<p><img src="rosetta/gzlmmixed/spss_rescale.png" class="img-responsive" alt=""></p>
<p>Now the interpretation of the coefficients is equivalent to the one
for R and GAMLj estimation, although the numerical estimates are still
different in SPSS. Not a big difference, but worth investigating the
reason.</p>
<p><img src="rosetta/gzlmmixed/results_spss_fixed2.png" class="img-responsive" alt=""></p>
<p>As regards the random coefficients variance, it is quite different
from the R or GAMLj results.</p>
<p><img src="rosetta/gzlmmixed/results_spss_random.png" class="img-responsive" alt=""></p>
<p>Finally, as regards the omnibus tests, SPSS outputs the F-tests, not
the Chi-square. Nevertheless, the p-values associated with the tests are
in line with the ones obtained in GAMLj and R.</p>
<p><img src="rosetta/gzlmmixed/results_spss_chi.png" class="img-responsive" alt=""></p>
<p>Thus, GAMLj and R <code>lme4::glmer</code> produce results that are
numerically very close and practically identical. SPSS produces results
that are numerically different but substantially equivalent to the other
software results.</p>
</div>
</div>
<div id="rosettas-files" class="section level1">
<h1>Rosetta’s files</h1>
<ul>
<li>
<a href="./rosetta_contrasts.html">Rosetta store: contrasts</a>
</li>
<li>
<a href="./rosetta_simpleint.html">Simple Effects and Simple
Interactions</a>
</li>
<li>
<a href="./rosetta_gzlmmixed1.html">Rosetta store: Generalized Mixed</a>
</li>
<li>
<a href="./rosetta_moderation.html">Rosetta store: moderation</a>
</li>
</ul>
</div>
<div id="comments" class="section level1 adm adm-warning">
<h1>Comments?</h1>
<p>
Got comments, issues or spotted a bug? Please open an issue on
<a href="https://github.com/gamlj/gamlj//issues " target="_blank"> GAMLj
at github</a> or <a href="mailto:mcfanda@gmail.com

">send me an email</a>
</p>
</div>
</div>

   
   
            
      

  <script>
    $(document).ready(function () {

			
 		
		$('#content img:not(.no-lightbox)').addClass("image-lb");
	$('#content').magnificPopup({
	    type:'image',
	    closeOnContentClick: false,
	    closeBtnInside: false,
	    delegate: '.image-lb',
	    gallery: {enabled: false },
	    image: {
	        verticalFit: true,
		titleSrc: 'alt'
	    }
 	});
 	    });
  </script>



    <!-- dynamically load mathjax for compatibility with self-contained -->
  <script>
    (function () {
	var script = document.createElement("script");
	script.type = "text/javascript";
	script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
	document.getElementsByTagName("head")[0].appendChild(script);
    })();
  </script>
  
</body>
</html>
