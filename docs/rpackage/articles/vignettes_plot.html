<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Plots in GAMLj â€¢ GAMLj3</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Plots in GAMLj">
<meta property="og:description" content="GAMLj3">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">GAMLj3</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.3.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/vignettes_gamlj_lm.html">Examples of gamlj_lm()</a>
    </li>
    <li>
      <a href="../articles/vignettes_gamlj_methods.html">Examples of GAMLj Methods</a>
    </li>
    <li>
      <a href="../articles/vignettes_plot.html">Plots in GAMLj</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Plots in GAMLj</h1>
                        <h4 data-toc-skip class="author">Marcello
Gallucci</h4>
            
            <h4 data-toc-skip class="date">2024-07-15</h4>
      
      
      <div class="hidden name"><code>vignettes_plot.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">GAMLj3</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="obtaining-a-plot">Obtaining a plot<a class="anchor" aria-label="anchor" href="#obtaining-a-plot"></a>
</h2>
<p><code>GAMLj</code> functions
(<code><a href="../reference/gamlj_lm.html">gamlj_lm()</a></code>,<code><a href="../reference/gamlj_glm.html">gamlj_glm()</a></code>,<code><a href="../reference/gamlj_mixed.html">gamlj_mixed()</a></code>
and <code><a href="../reference/gamlj_gmixed.html">gamlj_gmixed()</a></code>) can produce plots including up to three
variables. The plots portrait the model predicted values in the Y-axis.
Using the functions, one can obtain the plots by using the following
options:</p>
<ul>
<li>
<code>plot_x</code> the variable in the X-axis</li>
<li>
<code>plot_z</code> the moderator variable, whose levels define the
traces (separated lines)</li>
<li>
<code>plot_by</code> the variable whose levels define the two-way
interactions in multiple plots (separated plots)</li>
</ul>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>We use the <code>iris</code> R dataframe. Assume we want to plot the
influence of <code>Sepal.Width</code>, <code>Petal.Length</code> and
<code>Petal.Width</code> on <code>Sepal.Length</code>, and their
interactions. We use <code><a href="../reference/gamlj_lm.html">gamlj_lm()</a></code> to estimate the model and
ask for the plots.</p>
<p>First we ask for the plot of the main effect of
<code>Sepal.Width</code>. We use <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> without any option
to extract the plot from the galmj results object.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/gamlj_lm.html">gamlj_lm</a></span><span class="op">(</span>formula<span class="op">=</span><span class="va">Sepal.Length</span><span class="op">~</span><span class="va">Sepal.Width</span><span class="op">*</span><span class="va">Petal.Length</span><span class="op">*</span><span class="va">Petal.Width</span>, </span>
<span>              data<span class="op">=</span><span class="va">iris</span>,</span>
<span>              plot_x <span class="op">=</span> <span class="st">"Sepal.Width"</span></span>
<span>              <span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignettes_plot_files/figure-html/unnamed-chunk-3-1.png" width="576" style="display: block; margin: auto;"></p>
<p>To have additional plots, we can re-estimate the model using the
options described above or using <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>. The function
<code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> accepts either a formula or character options. The
formula is a right hand side formula specifying the X-axis variable and
the (optional) moderators.</p>
<p>Examples are:</p>
<div class="section level3">
<h3 id="one-way-plots">One-way plots<a class="anchor" aria-label="anchor" href="#one-way-plots"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span>,formula <span class="op">=</span> <span class="op">~</span><span class="va">Petal.Length</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignettes_plot_files/figure-html/unnamed-chunk-4-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="two-way-plots">Two-way plots<a class="anchor" aria-label="anchor" href="#two-way-plots"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span>,formula <span class="op">=</span> <span class="op">~</span><span class="va">Sepal.Width</span><span class="op">:</span><span class="va">Petal.Length</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignettes_plot_files/figure-html/unnamed-chunk-5-1.png" width="576" style="display: block; margin: auto;"></p>
<p>Because the moderator variable <code>Petal.Length</code> is a
continuous variable, the function plots the independent variable effect
at three different levels of the moderator. By default, the three levels
are the mean, the mean plus one standard deviation and the mean minus
one standard deviation. The conditioning values can be changed with the
option <code>covs_conditioning</code>. The option accepts
<code>mean_sd</code> (default) and <code>percent</code>, for 25th,50th,
and 75th percentiles.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span>,formula <span class="op">=</span> <span class="op">~</span><span class="va">Sepal.Width</span><span class="op">:</span><span class="va">Petal.Length</span>, covs_conditioning<span class="op">=</span><span class="st">"percent"</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignettes_plot_files/figure-html/unnamed-chunk-6-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="three-way-plots">Three-way plots<a class="anchor" aria-label="anchor" href="#three-way-plots"></a>
</h3>
<p>A three-way plot produces one plot for each level of the last
moderator, in this case three plots.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plots</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span>,formula <span class="op">=</span> <span class="op">~</span><span class="va">Sepal.Width</span><span class="op">:</span><span class="va">Petal.Length</span><span class="op">:</span><span class="va">Petal.Width</span><span class="op">)</span></span>
<span><span class="va">garbage</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">plots</span>,<span class="va">print</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignettes_plot_files/figure-html/unnamed-chunk-7-1.png" width="576" style="display: block; margin: auto;"></p>
<p>Because the formula is expanded, one can obtain all main effects and
interactions plots in one call by passing
<code>formula=~Sepal.Width*Petal.Length*Petal.Width</code></p>
</div>
</div>
<div class="section level2">
<h2 id="factors">Factors<a class="anchor" aria-label="anchor" href="#factors"></a>
</h2>
<p>When the X-axis variable is a factor, a plot of means is
produced.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod2</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/gamlj_lm.html">gamlj_lm</a></span><span class="op">(</span>formula<span class="op">=</span><span class="va">Sepal.Length</span><span class="op">~</span><span class="va">Species</span>,  data<span class="op">=</span><span class="va">iris</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod2</span>,formula<span class="op">=</span><span class="op">~</span><span class="va">Species</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignettes_plot_files/figure-html/unnamed-chunk-8-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="character-options">Character options<a class="anchor" aria-label="anchor" href="#character-options"></a>
</h2>
<p>Alternatively, the function accepts characters options. The three
options relevant here are:</p>
<ul>
<li>
<code>plot_x</code> defining the variable in the X-axis</li>
<li>
<code>plot_z</code> defining the variable whose levels define the
way the effect of the variable in the X-axis is broken down (the
moderator)</li>
<li>
<code>plot_by</code> defining the variable whose levels define the
way the two-way interaction is broken down</li>
</ul>
<p>A two-way plot, for instance, can be obtained as follows:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span>,plot_x<span class="op">=</span><span class="st">"Sepal.Width"</span>, plot_z<span class="op">=</span><span class="st">"Petal.Length"</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignettes_plot_files/figure-html/unnamed-chunk-9-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="other-options">Other options<a class="anchor" aria-label="anchor" href="#other-options"></a>
</h2>
<p>The function <code>plot</code> accepts any option which is accepted
by <code>gaml*</code> functions. The most relevant for producing plots
are:</p>
<ul>
<li>
<code>plot_raw</code> (logical) to plot the observed scores along
the predicted values</li>
<li>
<code>plot_yscale</code> (logical) to set the range of the Y-axis
equal to the actual range of the dependent variable (it does not apply
to generalized linear models)</li>
<li>
<code>plot_xoriginal</code> (logical) to set the scale of the X-axis
as the original variable, so not centered or standardized</li>
<li>
<code>plot_around</code> to add confidence intervals bars
(<code>ci</code>) or error bars <code>se</code> along the predicted
values. Default is <code>none</code>.</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span>,plot_x<span class="op">=</span><span class="st">"Sepal.Width"</span>, plot_z<span class="op">=</span><span class="st">"Petal.Length"</span>, plot_raw<span class="op">=</span><span class="cn">T</span>,plot_around<span class="op">=</span><span class="st">"ci"</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignettes_plot_files/figure-html/unnamed-chunk-10-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod2</span>,formula<span class="op">=</span><span class="op">~</span><span class="va">Species</span>,plot_raw<span class="op">=</span><span class="cn">T</span>,plot_around<span class="op">=</span><span class="st">"se"</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignettes_plot_files/figure-html/unnamed-chunk-10-2.png" width="576" style="display: block; margin: auto;"></p>
<p>In addition, the plot can be saved in a variable and manipulated as
any other ggplot object, for instance to change the theme or add a
title.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span>,plot_x<span class="op">=</span><span class="st">"Sepal.Width"</span>, plot_z<span class="op">=</span><span class="st">"Petal.Length"</span>, plot_raw<span class="op">=</span><span class="cn">T</span>,plot_around<span class="op">=</span><span class="st">"ci"</span><span class="op">)</span></span>
<span><span class="va">p</span><span class="op">+</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"A nice plot"</span><span class="op">)</span><span class="op">+</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignettes_plot_files/figure-html/unnamed-chunk-11-1.png" width="576" style="display: block; margin: auto;"></p>
<p>In case of multiple plots produced, the ggplot objects are contained
in a list returned by <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>.</p>
</div>
<div class="section level2">
<h2 id="other-gamlj-functions">Other GAMLj functions<a class="anchor" aria-label="anchor" href="#other-gamlj-functions"></a>
</h2>
<p>All model functions in GAMLj,
(<code><a href="../reference/gamlj_lm.html">gamlj_lm()</a></code>,<code><a href="../reference/gamlj_glm.html">gamlj_glm()</a></code>,<code><a href="../reference/gamlj_mixed.html">gamlj_mixed()</a></code>
and <code><a href="../reference/gamlj_gmixed.html">gamlj_gmixed()</a></code>), can produce plots using the options
and functions described above. Here an example with a generalized
(logistic) mixed model in which we plot the fixed and random effects
predicted values.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"clustermanymodels"</span><span class="op">)</span></span>
<span><span class="va">clustermanymodels</span><span class="op">$</span><span class="va">ybin</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">clustermanymodels</span><span class="op">$</span><span class="va">ybin</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mod3</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/gamlj_gmixed.html">gamlj_gmixed</a></span><span class="op">(</span>formula<span class="op">=</span><span class="va">ybin</span><span class="op">~</span><span class="va">z</span><span class="op">+</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">z</span><span class="op">|</span><span class="va">cluster</span><span class="op">)</span>,data<span class="op">=</span><span class="va">clustermanymodels</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod3</span>, plot_x <span class="op">=</span> <span class="st">"z"</span>,plot_re<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignettes_plot_files/figure-html/unnamed-chunk-13-1.png" width="576" style="display: block; margin: auto;"></p>
<p><a href="#plots-in-gamlj">back to top</a></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Marcello Gallucci.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
