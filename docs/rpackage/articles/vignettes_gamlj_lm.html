<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Examples of gamlj_lm() • GAMLj3</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Examples of gamlj_lm()">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">GAMLj3</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.4.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/vignettes_defining_model.html">Defining the model</a>
    </li>
    <li>
      <a href="../articles/vignettes_gamlj_lm.html">Examples of gamlj_lm()</a>
    </li>
    <li>
      <a href="../articles/vignettes_gamlj_methods.html">Examples of GAMLj Methods</a>
    </li>
    <li>
      <a href="../articles/vignettes_plot.html">Plots in GAMLj</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Examples of gamlj_lm()</h1>
                        <h4 data-toc-skip class="author">Marcello
Gallucci</h4>
            
            <h4 data-toc-skip class="date">2024-10-14</h4>
      

      <div class="hidden name"><code>vignettes_gamlj_lm.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">GAMLj3</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="linear-models-in-gamlj">Linear models in GAMLj<a class="anchor" aria-label="anchor" href="#linear-models-in-gamlj"></a>
</h2>
<p>In this example we run a moderated regression analysis with simple
slopes analysis and simple slopes graphs. Data are from <a href="https://psycnet.apa.org/record/2002-18109-000" class="external-link">Cohen et al
2003</a> and can be downloaded <a href="https://github.com/mcfanda/gamlj_docs/blob/master/data/exercise.csv" class="external-link">here</a>.</p>
</div>
<div class="section level2">
<h2 id="the-research-design">The research design<a class="anchor" aria-label="anchor" href="#the-research-design"></a>
</h2>
<p>The research is about physical endurance associated with age and
physical exercise. 245 participants were measured while jogging on a
treadmill. Endurance was measured in minutes (‘yendu’ in the file).
Participants’ age (<code>xage</code> in years) and number of years of
physical exercise (<code>zexer</code> in years) were recorded as
well</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">"https://raw.githubusercontent.com/mcfanda/gamlj_docs/master/data/exercise.csv"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"xage"</span>,<span class="st">"zexer"</span>,<span class="st">"yendu"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code>      xage          zexer          yendu     
 Min.   :20.0   Min.   : 0.0   Min.   : 0.0  
 1st Qu.:43.0   1st Qu.: 7.0   1st Qu.:19.0  
 Median :48.0   Median :11.0   Median :27.0  
 Mean   :49.2   Mean   :10.7   Mean   :26.5  
 3rd Qu.:56.0   3rd Qu.:14.0   3rd Qu.:33.0  
 Max.   :82.0   Max.   :26.0   Max.   :55.0  </code></pre>
<p>The researcher is interested in studying the relationships between
endurance, age, and exercising, with the hypothesis that the effect of
age (expected to be negative) is moderated by exercise, such that the
more participants work out (higher levels of <code>exer</code>) the less
age negatively affects endurance.</p>
</div>
<div class="section level2">
<h2 id="understanding-the-problem">Understanding the problem<a class="anchor" aria-label="anchor" href="#understanding-the-problem"></a>
</h2>
<p>We can think about this analytic problem as a multiple regression,
where the effect of age and exercise can be estimated while keeping
constant the other variable. However, the researcher puts forward a
<em>moderation hypothesis</em>, because s/he expects the effect of age
to change for different levels of exercising. We than need an
interaction between age and exercise.</p>
<p>We first run a multiple regression (to warm up), then we estimate a
multiple regression with an interaction (moderated regression) and we
probe the interaction with a simple slope analysis and simple slope
graphs. Technical details can be found in <a href="https://psycnet.apa.org/record/2002-18109-000" class="external-link">Cohen et al
2003</a>, or in <a href="http://quantpsy.org/interact/interactions.htm" class="external-link">Preacher
website</a>.</p>
</div>
<div class="section level2">
<h2 id="multiple-regression">Multiple regression<a class="anchor" aria-label="anchor" href="#multiple-regression"></a>
</h2>
<p>GAMLj <code><a href="../reference/gamlj_lm.html">gamlj_lm()</a></code> function minimum setup only requires to
specify the formula of the model and the dataframe. The formula
interface is the same one used in <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code> function.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod1</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/gamlj_lm.html">gamlj_lm</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">yendu</span><span class="op">~</span><span class="va">xage</span><span class="op">+</span><span class="va">zexer</span>, data<span class="op">=</span><span class="va">data</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod1</span></span></code></pre></div>
<pre><code>
 GENERAL LINEAR MODEL

 Model Info                                                            
 ───────────────────────────────────────────────────────────────────── 
   Info                                                                
 ───────────────────────────────────────────────────────────────────── 
   Model Type       Linear Model    OLS Model for continuous y         
   Model            lm              yendu ~ 1 + xage + zexer           
   Distribution     Gaussian        Normal distribution of residuals   
   Omnibus Tests    F                                                  
   Sample size               245                                       
   Converged        yes                                                
   Y transform      none                                               
   C.I. method      Wald                                               
 ───────────────────────────────────────────────────────────────────── 
   Note. All covariates are centered to the mean


 MODEL RESULTS

 Model Fit                                                
 ──────────────────────────────────────────────────────── 
   R²       Adj. R²    df    df (res)    F       p        
 ──────────────────────────────────────────────────────── 
   0.166      0.159     2         242    24.1    &lt; .001   
 ──────────────────────────────────────────────────────── 


 ANOVA Omnibus tests                                            
 ────────────────────────────────────────────────────────────── 
                SS           df     F         p         η²p     
 ────────────────────────────────────────────────────────────── 
   Model         4750.686      2    24.142    &lt; .001    0.166   
   xage          1515.825      1    15.406    &lt; .001    0.060   
   zexer         4298.311      1    43.687    &lt; .001    0.153   
   Residuals    23810.334    242                                
   Total        28561.020    244                                
 ────────────────────────────────────────────────────────────── 


 Parameter Estimates (Coefficients)                                                                           
 ──────────────────────────────────────────────────────────────────────────────────────────────────────────── 
   Names          Effect         Estimate    SE       Lower     Upper     β         df     t         p        
 ──────────────────────────────────────────────────────────────────────────────────────────────────────────── 
   (Intercept)    (Intercept)      26.531    0.634    25.282    27.779    -0.000    242    41.865    &lt; .001   
   xage           xage             -0.257    0.066    -0.386    -0.128    -0.240    242    -3.925    &lt; .001   
   zexer          zexer             0.916    0.139     0.643     1.189     0.404    242     6.610    &lt; .001   
 ──────────────────────────────────────────────────────────────────────────────────────────────────────────── </code></pre>
<p>The object `mod’ is an R6 object which contains all the results
tables and some additional function that can be used in subsequent
analyses. Tables are pretty printed, but they can be modified or
manipulated by transforming them in dataframes as follows:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">anovaDF</span><span class="op">&lt;-</span><span class="va">mod1</span><span class="op">$</span><span class="va">main</span><span class="op">$</span><span class="va">anova</span><span class="op">$</span><span class="va">asDF</span></span>
<span><span class="va">anovaDF</span></span></code></pre></div>
<pre><code>     source    ss  df    f        p etaSqP
1     Model  4751   2 24.1 2.75e-10 0.1663
2      xage  1516   1 15.4 1.13e-04 0.0599
3     zexer  4298   1 43.7 2.44e-10 0.1529
4 Residuals 23810 242   NA       NA     NA
5     Total 28561 244   NA       NA     NA</code></pre>
<p>More generally, the whole results object can be rendered in simple
tables with the command <code>summary</code></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span></span></code></pre></div>
<pre><code>Model Info 

           info        value                            specs
1    Model Type Linear Model       OLS Model for continuous y
2         Model           lm         yendu ~ 1 + xage + zexer
3  Distribution     Gaussian Normal distribution of residuals
4 Omnibus Tests            F                                 
5   Sample size          245                                 
6     Converged          yes                                 
7   Y transform         none                                 
8   C.I. method         Wald                                 


Model Fit 

     r2   ar2 df1 df2    f        p
1 0.166 0.159   2 242 24.1 2.75e-10


ANOVA Omnibus tests 

     source    ss  df    f        p etaSqP
1     Model  4751   2 24.1 2.75e-10 0.1663
2      xage  1516   1 15.4 1.13e-04 0.0599
3     zexer  4298   1 43.7 2.44e-10 0.1529
4 Residuals 23810 242   NA       NA     NA
5     Total 28561 244   NA       NA     NA


Parameter Estimates (Coefficients) 

       source       label estimate     se est.ci.lower est.ci.upper      beta
1 (Intercept) (Intercept)   26.531 0.6337       25.282       27.779 -1.49e-16
2        xage        xage   -0.257 0.0655       -0.386       -0.128 -2.40e-01
3       zexer       zexer    0.916 0.1386        0.643        1.189  4.04e-01
   df  test         p
1 242 41.87 7.83e-113
2 242 -3.93  1.13e-04
3 242  6.61  2.44e-10</code></pre>
<p><code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> return a list of data.frame, one for each
table, that can be further manipulated or modified.</p>
<div class="section level3">
<h3 id="results">Results<a class="anchor" aria-label="anchor" href="#results"></a>
</h3>
<p>Results show three tables. The <em>Model Info</em> table contains
information about the overall model. The <em>ANOVA omnibus tests</em>
table contains the results of the <code>car:Anova()</code> function,
with the addition of the partial
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>η</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\eta^2</annotation></semantics></math>
index for each effect and the inferential test for the whole model. The
<em>Parameter Estimates</em> table contains the <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>
results. For each coefficient the confidence interval is also
reported.</p>
<p>A special note should be made for the intercept. The intercept is the
expected value (the mean) of the dependent variable, estimated for all
independent variables equal to their means. This is because in
<code><a href="../reference/gamlj_lm.html">gamlj_lm()</a></code>, continuous variables are centered to their mean
by default. In case one wants the independent variables not to be
centered, one can select a different scaling with the option
<code>scaling</code>.</p>
<p>Additional effect size indexes can be asked with the option
<code>effectSize</code>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod2</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/gamlj_lm.html">gamlj_lm</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">yendu</span><span class="op">~</span><span class="va">xage</span><span class="op">+</span><span class="va">zexer</span>, </span>
<span>               data<span class="op">=</span><span class="va">data</span>,</span>
<span>               es <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"beta"</span>, <span class="st">"eta"</span>,<span class="st">"etap"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod2</span><span class="op">$</span><span class="va">main</span><span class="op">$</span><span class="va">anova</span></span></code></pre></div>
<pre><code>
 ANOVA Omnibus tests                                                      
 ──────────────────────────────────────────────────────────────────────── 
                SS           df     F         p         η²        η²p     
 ──────────────────────────────────────────────────────────────────────── 
   Model         4750.686      2    24.142    &lt; .001    0.1663    0.166   
   xage          1515.825      1    15.406    &lt; .001    0.0531    0.060   
   zexer         4298.311      1    43.687    &lt; .001    0.1505    0.153   
   Residuals    23810.334    242                                          
   Total        28561.020    244                                          
 ──────────────────────────────────────────────────────────────────────── </code></pre>
<p>The same analysis can be done by updating the model with the
<code><a href="https://rdrr.io/r/stats/update.html" class="external-link">update()</a></code> function. Almost all the options available in
<code><a href="../reference/gamlj_lm.html">gamlj_lm()</a></code> can be added to a model by running
<code>update(mod,...)</code> where <code>...</code> is any option or
options accepted by <code><a href="../reference/gamlj_lm.html">gamlj_lm()</a></code>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod2_2</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">mod1</span>,es <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"beta"</span>, <span class="st">"eta"</span>,<span class="st">"etap"</span>,<span class="st">"omega"</span>,<span class="st">"epsilon"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod2_2</span><span class="op">$</span><span class="va">main</span><span class="op">$</span><span class="va">anova</span></span></code></pre></div>
<pre><code>
 ANOVA Omnibus tests                                                                        
 ────────────────────────────────────────────────────────────────────────────────────────── 
                SS           df     F         p         η²        η²p      ω²       ε²      
 ────────────────────────────────────────────────────────────────────────────────────────── 
   Model         4750.686      2    24.142    &lt; .001    0.1663    0.166    0.159    0.159   
   xage          1515.825      1    15.406    &lt; .001    0.0531    0.060    0.049    0.050   
   zexer         4298.311      1    43.687    &lt; .001    0.1505    0.153    0.147    0.147   
   Residuals    23810.334    242                                                            
   Total        28561.020    244                                                            
 ────────────────────────────────────────────────────────────────────────────────────────── </code></pre>
</div>
</div>
<div class="section level2">
<h2 id="moderated-regression">Moderated regression<a class="anchor" aria-label="anchor" href="#moderated-regression"></a>
</h2>
<p>To include the interaction we simply add the interaction effect in
the formula.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod3</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/gamlj_lm.html">gamlj_lm</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">yendu</span><span class="op">~</span><span class="va">xage</span><span class="op">*</span><span class="va">zexer</span>, </span>
<span>               data<span class="op">=</span><span class="va">data</span>,</span>
<span>               es <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"beta"</span>, <span class="st">"eta"</span>,<span class="st">"etap"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod3</span><span class="op">$</span><span class="va">main</span><span class="op">$</span><span class="va">anova</span></span></code></pre></div>
<pre><code>
 ANOVA Omnibus tests                                                       
 ───────────────────────────────────────────────────────────────────────── 
                 SS           df     F         p         η²        η²p     
 ───────────────────────────────────────────────────────────────────────── 
   Model          5887.234      3    20.858    &lt; .001    0.2061    0.206   
   xage           1569.837      1    16.686    &lt; .001    0.0550    0.065   
   zexer          4775.348      1    50.757    &lt; .001    0.1672    0.174   
   xage:zexer     1136.548      1    12.080    &lt; .001    0.0398    0.048   
   Residuals     22673.786    241                                          
   Total         28561.020    244                                          
 ───────────────────────────────────────────────────────────────────────── </code></pre>
<div class="section level3">
<h3 id="results-1">Results<a class="anchor" aria-label="anchor" href="#results-1"></a>
</h3>
<p>Because variables are centered to their means, the first-order
coefficients can be interpreted as “average” effects. One can also
report the betas
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>).
The estimates of the betas are correct also in the presence of the
interaction, because the variables are standardized before the
interaction term is computed.</p>
</div>
<div class="section level3">
<h3 id="simple-slopes">Simple Slopes<a class="anchor" aria-label="anchor" href="#simple-slopes"></a>
</h3>
<p>We can now probe the interaction. One can re-run the model adding the
appropriate options to ask for simple effects or one can use the
<code>gamlj_simpleffects()</code> function, which is a convenience
function to add simple effects to a pre-existing model. The function
<code>gamlj_simpleffects()</code>, however, only returns the simple
effects tables, not the full model.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod3b</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/gamlj_lm.html">gamlj_lm</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">yendu</span><span class="op">~</span><span class="va">xage</span><span class="op">*</span><span class="va">zexer</span>, </span>
<span>               data<span class="op">=</span><span class="va">data</span>,</span>
<span>               simple_x <span class="op">=</span> <span class="st">"xage"</span>,</span>
<span>               simple_mods <span class="op">=</span> <span class="st">"zexer"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod3b</span><span class="op">$</span><span class="va">simpleEffects</span></span></code></pre></div>
<pre><code>
 SIMPLE EFFECTS

 ANOVA for Simple Effects  of xage                              
 ────────────────────────────────────────────────────────────── 
   zexer        F         Num df    Den df    p         η²p     
 ────────────────────────────────────────────────────────────── 
   Mean-1·SD    27.972         1       241    &lt; .001    0.104   
   Mean         16.686         1       241    &lt; .001    0.065   
   Mean+1·SD     0.160         1       241     0.690    0.001   
 ────────────────────────────────────────────────────────────── 


 Parameter Estimates for simple effects of xage                                                        
 ───────────────────────────────────────────────────────────────────────────────────────────────────── 
   zexer        Effect    Estimate    SE       Lower     Upper     β         df     t         p        
 ───────────────────────────────────────────────────────────────────────────────────────────────────── 
   Mean-1·SD    xage        -0.487    0.092    -0.669    -0.306    -0.455    241    -5.289    &lt; .001   
   Mean         xage        -0.262    0.064    -0.388    -0.135    -0.244    241    -4.085    &lt; .001   
   Mean+1·SD    xage        -0.036    0.090    -0.214     0.142    -0.034    241    -0.400     0.690   
 ───────────────────────────────────────────────────────────────────────────────────────────────────── </code></pre>
<p>Equivalently, we can do use the command
<code><a href="../reference/simple_effects.html">simple_effects()</a></code>:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">se</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/simple_effects.html">simple_effects</a></span><span class="op">(</span><span class="va">mod3</span>,simple_x <span class="op">=</span> <span class="st">"xage"</span>,simple_mods <span class="op">=</span> <span class="st">"zexer"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">se</span></span></code></pre></div>
<pre><code>
 SIMPLE EFFECTS

 ANOVA for Simple Effects  of xage                                         
 ───────────────────────────────────────────────────────────────────────── 
   zexer        F         Num df    Den df    p         η²         η²p     
 ───────────────────────────────────────────────────────────────────────── 
   Mean-1·SD    27.972         1       241    &lt; .001     0.0921    0.104   
   Mean         16.686         1       241    &lt; .001     0.0550    0.065   
   Mean+1·SD     0.160         1       241     0.690    5.27e-4    0.001   
 ───────────────────────────────────────────────────────────────────────── 


 Parameter Estimates for simple effects of xage                                                        
 ───────────────────────────────────────────────────────────────────────────────────────────────────── 
   zexer        Effect    Estimate    SE       Lower     Upper     β         df     t         p        
 ───────────────────────────────────────────────────────────────────────────────────────────────────── 
   Mean-1·SD    xage        -0.487    0.092    -0.669    -0.306    -0.455    241    -5.289    &lt; .001   
   Mean         xage        -0.262    0.064    -0.388    -0.135    -0.244    241    -4.085    &lt; .001   
   Mean+1·SD    xage        -0.036    0.090    -0.214     0.142    -0.034    241    -0.400     0.690   
 ───────────────────────────────────────────────────────────────────────────────────────────────────── </code></pre>
<p>In this way we obtain the effect of age computed for high exercise
(<code>zexer</code> centered to 1 SD above average), the main effect of
age (<code>zexer</code> centered to its mean) and the effect of age
computed for low exercise (<code>zexer</code> centered to -1 SD above
average). <code>gamlGLM()</code> produces both the F-tests and the
parameter estimates for the simple slopes. We focus on the latter table
now.</p>
<p>One can change the conditioning levels of the moderators with the
<code>covs_conditioning</code> option (default is <code>mean_sd</code>
for mean plus/minus one SD), either added to the <code><a href="../reference/gamlj_lm.html">gamlj_lm()</a></code>
function or to the <code><a href="../reference/simple_effects.html">simple_effects()</a></code> function. If one wants
to use the percentiles (25%,50%,75%), for instance, one can run the
following.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">se</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/simple_effects.html">simple_effects</a></span><span class="op">(</span><span class="va">mod3</span>,simple_x <span class="op">=</span> <span class="st">"xage"</span>,simple_mods <span class="op">=</span> <span class="st">"zexer"</span>,covs_conditioning<span class="op">=</span><span class="st">"percent"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">se</span></span></code></pre></div>
<pre><code>
 SIMPLE EFFECTS

 ANOVA for Simple Effects  of xage                                     
 ───────────────────────────────────────────────────────────────────── 
   zexer     F        Num df    Den df    p         η²         η²p     
 ───────────────────────────────────────────────────────────────────── 
   50-25%    28.15         1       241    &lt; .001    0.09273    0.105   
   50%       14.74         1       241    &lt; .001    0.04857    0.058   
   50+25%     1.81         1       241     0.180    0.00597    0.007   
 ───────────────────────────────────────────────────────────────────── 


 Parameter Estimates for simple effects of xage                                                     
 ────────────────────────────────────────────────────────────────────────────────────────────────── 
   zexer     Effect    Estimate    SE       Lower     Upper     β         df     t         p        
 ────────────────────────────────────────────────────────────────────────────────────────────────── 
   50-25%    xage        -0.435    0.082    -0.597    -0.274    -0.407    241    -5.306    &lt; .001   
   50%       xage        -0.246    0.064    -0.373    -0.120    -0.230    241    -3.840    &lt; .001   
   50+25%    xage        -0.105    0.078    -0.257     0.048    -0.098    241    -1.346     0.180   
 ────────────────────────────────────────────────────────────────────────────────────────────────── </code></pre>
<p>The simple effects are now changed, because they are estimated for a
different set of values of the moderator.</p>
<p>One can further tweak the appearance of the tables by selecting a
different value/labels in <code>covs_scale_labels</code> option. Options
are “labels”, “values” and “values_labels”. The latter outputs the
values and the labels of the conditioning values.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">se</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/simple_effects.html">simple_effects</a></span><span class="op">(</span><span class="va">mod3</span>,simple_x <span class="op">=</span> <span class="st">"xage"</span>,simple_mods <span class="op">=</span> <span class="st">"zexer"</span>,covs_conditioning<span class="op">=</span><span class="st">"percent"</span>,covs_scale_labels<span class="op">=</span><span class="st">"values_labels"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">se</span></span></code></pre></div>
<pre><code>
 SIMPLE EFFECTS

 ANOVA for Simple Effects  of xage                                            
 ──────────────────────────────────────────────────────────────────────────── 
   zexer            F        Num df    Den df    p         η²         η²p     
 ──────────────────────────────────────────────────────────────────────────── 
   50-25%=-3.673    28.15         1       241    &lt; .001    0.09273    0.105   
   50%=0.327        14.74         1       241    &lt; .001    0.04857    0.058   
   50+25%=3.327      1.81         1       241     0.180    0.00597    0.007   
 ──────────────────────────────────────────────────────────────────────────── 


 Parameter Estimates for simple effects of xage                                                            
 ───────────────────────────────────────────────────────────────────────────────────────────────────────── 
   zexer            Effect    Estimate    SE       Lower     Upper     β         df     t         p        
 ───────────────────────────────────────────────────────────────────────────────────────────────────────── 
   50-25%=-3.673    xage        -0.435    0.082    -0.597    -0.274    -0.407    241    -5.306    &lt; .001   
   50%=0.327        xage        -0.246    0.064    -0.373    -0.120    -0.230    241    -3.840    &lt; .001   
   50+25%=3.327     xage        -0.105    0.078    -0.257     0.048    -0.098    241    -1.346     0.180   
 ───────────────────────────────────────────────────────────────────────────────────────────────────────── </code></pre>
</div>
<div class="section level3">
<h3 id="simple-slopes-plot">Simple Slopes Plot<a class="anchor" aria-label="anchor" href="#simple-slopes-plot"></a>
</h3>
<p>We can get a clear picture of the interaction by asking for a plot.
Also the plot module takes care of centering the variables in a way that
makes the plot clearly understandable.</p>
<p>The options needed in <code><a href="../reference/gamlj_lm.html">gamlj_lm()</a></code> are <code>plot_x</code>
for the x-axis variable and <code>plot_z</code> for the moderator. At
which three levels of the moderator the separate lines are computed is
decided by the option <code>simpleScale</code> as for the simple
effects.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod4</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/gamlj_lm.html">gamlj_lm</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">yendu</span><span class="op">~</span><span class="va">xage</span><span class="op">*</span><span class="va">zexer</span>, data<span class="op">=</span><span class="va">data</span>, </span>
<span>               plot_x <span class="op">=</span> <span class="st">"xage"</span>,plot_z<span class="op">=</span> <span class="st">"zexer"</span><span class="op">)</span></span>
<span><span class="va">mod4</span></span></code></pre></div>
<p><img src="vignettes_gamlj_lm_files/figure-html/unnamed-chunk-21-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod4</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignettes_gamlj_lm_files/figure-html/unnamed-chunk-21-2.png" width="576" style="display: block; margin: auto;"></p>
<p>We use the<code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> function. The function, applied to a
<code>gamlj</code> results object, returns one plot if it is present in
the model, returned as a ggplot2 object. If more than one plot is
present, a list of plots is returned. FALSE is returned if no plot is
present or defined. The function <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> can also be use to
add new plots or to add options to the plots.</p>
<p>For instance, if we want to give a more honest account of the model
fit, we can visualize the simple slopes over the the actual data. The
function <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> produces a new plot after adding any
options accepted by <code><a href="../reference/gamlj_lm.html">gamlj_lm()</a></code></p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod4</span>,plot_raw<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignettes_gamlj_lm_files/figure-html/unnamed-chunk-22-1.png" width="576" style="display: block; margin: auto;"></p>
<p>Any plot produced by <code>gamlj_lm</code> or <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> can
be obtained as a ggplot2 object for further manipulations or usage. For
instance, one can change the theme of the plot:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myplot</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod4</span><span class="op">)</span></span>
<span><span class="va">myplot</span><span class="op">+</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_grey</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignettes_gamlj_lm_files/figure-html/unnamed-chunk-23-1.png" width="576" style="display: block; margin: auto;"></p>
<p><a href="#linear-models-in-gamlj">back to top</a></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Marcello Gallucci.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
