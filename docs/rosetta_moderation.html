<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="generator" content="pandoc" />

        <meta name="author" content="(Marcello Gallucci)" />
    
    
    <title>Rosetta store: moderation</title>

        <script src="site_libs/header-attrs-2.27/header-attrs.js"></script>
        <script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link href="site_libs/bootstrap-3.3.7/css/bootstrap.min.css" rel="stylesheet" />
        <script src="site_libs/bootstrap-3.3.7/js/bootstrap.min.js"></script>
        <script src="site_libs/navigation-1.1/tabsets.js"></script>
        <link href="site_libs/magnific-popup-1.1.0/magnific-popup.css" rel="stylesheet" />
        <script src="site_libs/magnific-popup-1.1.0/jquery.magnific-popup.min.js"></script>
        <link href="site_libs/readthedown-0.1/readthedown.css" rel="stylesheet" />
        <link href="site_libs/readthedown-0.1/readthedown_fonts_embed.css" rel="stylesheet" />
        <script src="site_libs/readthedown-0.1/readthedown.js"></script>
        <script>
        $(document).ready(function () {

            if ($(".root")[0]){
              return
            };
            $('.navbar-toggle').show();
            $('.navbar').css('display', 'none');
            $('#sidebar > h2 ').append("<a id='navbut' href=''><i class='fa fa-bars'></i></a>");
            $('#navbut').on( "click", function(e) {
                       $('.navbar').toggle();
                       e.preventDefault();
               } );
              $('.navbar-toggle').on('click', function(e) {
                       $('.navbar').toggle();
                       e.preventDefault();
              });       
            $(window).scroll(function (event) {
                $('.navbar').css('display', 'none');
            });       
        });
        </script>
        <!-- Google tag (gtag.js) -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-KM7X6HK5HM"></script>
        <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());

          gtag('config', 'G-KM7X6HK5HM');
        </script>
    
    
        <style type="text/css">code{white-space: pre;}</style>
    <style type="text/css">
      pre > code.sourceCode { white-space: pre; position: relative; }
      pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
      pre > code.sourceCode > span:empty { height: 1.2em; }
      .sourceCode { overflow: visible; }
      code.sourceCode > span { color: inherit; text-decoration: inherit; }
      div.sourceCode { margin: 1em 0; }
      pre.sourceCode { margin: 0; }
      @media screen {
      div.sourceCode { overflow: auto; }
      }
      @media print {
      pre > code.sourceCode { white-space: pre-wrap; }
      pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
      }
      pre.numberSource code
        { counter-reset: source-line 0; }
      pre.numberSource code > span
        { position: relative; left: -4em; counter-increment: source-line; }
      pre.numberSource code > span > a:first-child::before
        { content: counter(source-line);
          position: relative; left: -1em; text-align: right; vertical-align: baseline;
          border: none; display: inline-block;
          -webkit-touch-callout: none; -webkit-user-select: none;
          -khtml-user-select: none; -moz-user-select: none;
          -ms-user-select: none; user-select: none;
          padding: 0 4px; width: 4em;
          background-color: #ffffff;
          color: #a0a0a0;
        }
      pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
      div.sourceCode
        { color: #1f1c1b; background-color: #ffffff; }
      @media screen {
      pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
      }
      code span { color: #1f1c1b; } /* Normal */
      code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
      code span.an { color: #ca60ca; } /* Annotation */
      code span.at { color: #0057ae; } /* Attribute */
      code span.bn { color: #b08000; } /* BaseN */
      code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
      code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
      code span.ch { color: #924c9d; } /* Char */
      code span.cn { color: #aa5500; } /* Constant */
      code span.co { color: #898887; } /* Comment */
      code span.cv { color: #0095ff; } /* CommentVar */
      code span.do { color: #607880; } /* Documentation */
      code span.dt { color: #0057ae; } /* DataType */
      code span.dv { color: #b08000; } /* DecVal */
      code span.er { color: #bf0303; text-decoration: underline; } /* Error */
      code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
      code span.fl { color: #b08000; } /* Float */
      code span.fu { color: #644a9b; } /* Function */
      code span.im { color: #ff5500; } /* Import */
      code span.in { color: #b08000; } /* Information */
      code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
      code span.op { color: #1f1c1b; } /* Operator */
      code span.ot { color: #006e28; } /* Other */
      code span.pp { color: #006e28; } /* Preprocessor */
      code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
      code span.sc { color: #3daee9; } /* SpecialChar */
      code span.ss { color: #ff5500; } /* SpecialString */
      code span.st { color: #bf0303; } /* String */
      code span.va { color: #0057ae; } /* Variable */
      code span.vs { color: #bf0303; } /* VerbatimString */
      code span.wa { color: #bf0303; } /* Warning */
    </style>
    
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css" type="text/css" />
        <link rel="stylesheet" href="style.css" type="text/css" />
        <link rel="stylesheet" href="down.css" type="text/css" />
    
    <!-- tabsets -->
    <script>
      $(document).ready(function () {
	  window.buildTabsets("toc");
      });
      $(document).ready(function () {
	  $('.tabset-dropdown > .nav-tabs > li').click(function () {
	      $(this).parent().toggleClass('nav-tabs-open')
	  });
      });
    </script>

    <!-- code folding -->
    
    <!-- code download -->
    
    <!-- tabsets dropdown -->

    <style type="text/css">
      .tabset-dropdown > .nav-tabs {
	  display: inline-table;
	  max-height: 500px;
	  min-height: 44px;
	  overflow-y: auto;
	  background: white;
	  border: 1px solid #ddd;
	  border-radius: 4px;
      }
      
      .tabset-dropdown > .nav-tabs > li.active:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
	  content: "&#xe258;";
	  border: none;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .tabset-dropdown > .nav-tabs > li.active {
	  display: block;
      }

      .tabset-dropdown > .nav-tabs > li.active a {
  	  padding: 0 15px !important;
      }

      .tabset-dropdown > .nav-tabs > li > a,
      .tabset-dropdown > .nav-tabs > li > a:focus,
      .tabset-dropdown > .nav-tabs > li > a:hover {
	  border: none;
	  display: inline-block;
	  border-radius: 4px;
	  background-color: transparent;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li {
	  display: block;
	  float: none;
      }
      
      .tabset-dropdown > .nav-tabs > li {
	  display: none;
	  margin-left: 0 !important;
      }
    </style>
    
</head>

<body class="preload">

   	
         <!-- readthedown start -->   
   <div id="content" data-toggle="wy-nav-shift">
     <nav id="nav-top" role="navigation" aria-label="top navigation">
       <a role="button" href="#" data-toggle="wy-nav-top"><span class="glyphicon glyphicon-menu-hamburger"></span></a>
     </nav>
         
   
      
      <div class="navbar navbar-default  navbar-fixed-top" role="navigation">
        <div class="container">
          <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="index.html">GAMLj</a>
          </div>
          <div id="navbar" class="navbar-collapse collapse">
            <ul class="nav navbar-nav">
              <li>
        <a href="glm.html">GLM</a>
      </li>
      <li>
        <a href="mixed.html">Mixed</a>
      </li>
      <li>
        <a href="gzlm.html">Generalized</a>
      </li>
      <li>
        <a href="gzlmmixed.html">Generalized Mixed</a>
      </li>
      <li>
        <a href="examples.html">Examples</a>
      </li>
      <li>
        <a href="release_notes.html">Release notes</a>
      </li>
      <li>
        <a href="vignettes.html">GAMLj in R</a>
      </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
              <li>
        <a href="https://github.com/gamlj/gamlj">View on Github</a>
      </li>
            </ul>
          </div><!--/.nav-collapse -->
        </div><!--/.container -->
      </div><!--/.navbar -->
        
      <h1 class="title">Rosetta store: moderation</h1>
      
         <!-- readthedown authors -->
   <div id="sidebar">
    <h2><a href="#content">Rosetta store: moderation</a></h2>
    <div id="toc">
      <ul>
      <li><a href="#the-research-design"
      id="toc-the-research-design">The research design</a></li>
      <li><a href="#gamlj-glm" id="toc-gamlj-glm"><span
      class="modulename">GAMLj</span> GLM</a>
      <ul>
      <li><a href="#results" id="toc-results">Results</a></li>
      <li><a href="#simple-slopes" id="toc-simple-slopes">Simple
      Slopes</a></li>
      <li><a href="#simple-slopes-plot"
      id="toc-simple-slopes-plot">Simple Slopes Plot</a></li>
      </ul></li>
      <li><a href="#pure-r" id="toc-pure-r">Pure R</a>
      <ul>
      <li><a href="#simple-slope" id="toc-simple-slope">Simple
      Slope</a></li>
      <li><a href="#simple-slopes-plot-1"
      id="toc-simple-slopes-plot-1">Simple slopes plot</a></li>
      </ul></li>
      <li><a href="#r-emmeans" id="toc-r-emmeans">R emmeans</a></li>
      <li><a href="#pure-spss" id="toc-pure-spss">Pure SPSS</a>
      <ul>
      <li><a href="#simple-slopes-plot-2"
      id="toc-simple-slopes-plot-2">Simple slopes plot</a></li>
      </ul></li>
      <li><a href="#spss-process" id="toc-spss-process">SPSS
      PROCESS</a></li>
      <li><a href="#comments" id="toc-comments">Comments?</a></li>
      </ul>
    </div>
    <div id="postamble" data-toggle="wy-nav-shift" class="status">
                  <p class="author"><span class="glyphicon glyphicon-user"></span> (Marcello
Gallucci)</p>
                      </div>
   </div>
     

   
      
   
<!-- Don't indent these lines or it will mess pre blocks indentation --> 
<div id="main">
<p><span class="keywords"> <span class="keytitle"> keywords </span>
jamovi, SPSS, R, Multiple regression, moderated regression, simple
slopes, PROCESS </span></p>
<div class="version">
<p>
0.9.1
</p>
</div>
<div style="clear:both">

</div>
<p><span class="draft"> Draft version, mistakes may be around
</span></p>
<p>Here you can find comparisons of results obtained in jamovi <span
class="modulename">GAMLj</span>, pure R, and SPSS. When not explicitly
discussed, the code of different software is written with the aim of
obtaining identical results across programs (not necessarily with the
most efficient strategy).</p>
<p>In this example we tackle a moderated regression analysis with simple
slopes analysis and simple slopes graphs. Data are from <a
href="http://psycnet.apa.org/record/2002-18109-000">Cohen et al 2003</a>
and can be downloaded <a
href="https://github.com/mcfanda/%3Cspan%20class=%22modulename%22%3EGAMLj%3C/span%3E_docs/blob/master/data/exercise.csv">here</a>.
<span class="modulename">GAMLj</span> analyses on this dataset (without
comparisons with other software) can be found in
<a href="glm_example1.html">GLM: Multiple regression, moderated
regression, and simple slopes</a>.</p>
<div id="the-research-design" class="section level1">
<h1>The research design</h1>
<p>The research is about physical endurance associated with age and
physical exercise. 245 participants were measured while jogging on a
treadmill. Edurance was measured in minutes (‘yendu’ in the file).
Participants’ age (<code>xage</code> in years) and number of years of
physical exercise (<code>zexer</code> in years) were recorded as well
(in
<code>r</code>jamovi<code></code>Exploration<code>-&gt;</code>Descriptive`)</p>
<p><img src="examples/glm1/desc.png" class="img-responsive" alt=""></p>
<p>The researcher is interested in studying the relationships between
endurance, age, and exercising, with the hypothesis that the effect of
age (not unexpectedly negative) is moderated by exercise, such that the
more participants work out (higher levels of <code>exer</code>) the less
age negatively affects endurance.</p>
<p>For a longer discussion please check out
<a href="glm_example1.html">GLM: Multiple regression, moderated
regression, and simple slopes</a>.</p>
</div>
<div id="gamlj-glm" class="section level1">
<h1><span class="modulename">GAMLj</span> GLM</h1>
<p><span
class="jamovi"><a href="http://www.jamovi.org" target="_blank">jamovi</a></span>
<code>r</code>modulename()` module for GLM requires to set the variables
in the right field depending on their role in the model and their
type.</p>
<p><img src="examples/glm1/variables.png" class="img-responsive" alt=""></p>
<p>Thus, we push <code>yendu</code> in the
<code>Dependent Variable</code> field and both <code>xage</code> and
<code>zexer</code> in the <code>Covariates</code> field, being both
variables quantitative.</p>
<p>As soon as the variables are set, jamovi fills in the tables in the
output panel with the estimation results. However, it is worth noticing
that the statistical model has been defined by default by the software:
We can see that in the <code>Model</code> tab.</p>
<p><img src="examples/glm1/model.png" class="img-responsive" alt=""></p>
<p>jamovi, following a somehow old tradition established by SPSS,
automatically includes continuous independent variables in the model
without their interaction. For categorical variables the default
behavior is to include both main effects and interactions.</p>
<p>To include the interaction we simply add the interaction effect in
the <code>Model Terms</code> under the <code>Model</code> tab.</p>
<p><img src="examples/glm1/model2.png" class="img-responsive" alt=""></p>
<p>The interaction is pushed in the <code>Model Terms</code> by
selecting the variables on the left and click <code>interaction</code>
in the “arrow” cascade menu.</p>
<p><img src="glm/interactions.png" class="img-responsive" alt=""></p>
<div id="results" class="section level2">
<h2>Results</h2>
<p>Let’s us first focus on the parameters estimates, the B
coefficients.</p>
<p><img src="examples/glm1/resultsmoderate.png" class="img-responsive" alt=""></p>
<p><span class="modulename">GAMLj</span>, by default, centers the
variables and estimate main effects and interactions as expected by
modern analysts. If one needs more advanced centering,
<code>Covariates Scaling</code> option panel can be of interest.</p>
<p>One can also report the betas (last column in the
<code>Model Coefficients</code> table). Please notice that jamovi GLM
the estimates of the betas are correct also in the presence of the
interaction, because the variables are standardized before the
interaction term is computed.</p>
</div>
<div id="simple-slopes" class="section level2">
<h2>Simple Slopes</h2>
<p>We can now probe the interaction. We go to
<code>Simple effects</code> tab and select <code>xage</code> as
<code>Simple effec variable</code> and <code>zexer</code> as
<code>Moderator</code>. In this way we obtain the effect of age computed
for high exercise (<code>zexer</code> centered to 1 SD above average,
4.78), the main effect of age (<code>zexer</code> centered to its mean,
that is 0) and the effect of age computed for low exercise
(<code>zexer</code> centered to -1 SD above average, -4.78).</p>
<p>jamovi GLM produces both the F-tests and the parameter estimates for
the simple slopes. The parameters estimates are:</p>
<p><img src="examples/glm1/resultssimple.png" class="img-responsive" alt=""></p>
<p>and the F-tests are:</p>
<p>&lt;img src=“rosetta/moderation/r.<span
class="modulename">GAMLj</span>3.png” class=“img-responsive”
alt=““&gt;</p>
</div>
<div id="simple-slopes-plot" class="section level2">
<h2>Simple Slopes Plot</h2>
<p>We can get a clear picture of the interaction by asking for a plot.
Also the plot module takes care of centering the variables in a way that
makes the plot clearly understandable.</p>
<p><img src="examples/glm1/plots.png" class="img-responsive" alt=""></p>
<p>It plots the effect of the <code>Horizontal axis</code> variable for
three levels (-1 SD, mean, +1 SD) of the <code>Separate Lines</code>
variable.</p>
<p><img src="examples/glm1/resultsplot.png" class="img-responsive" alt=""></p>
<p>The nice plot we get shows the simple effects (simple equations to be
precise) with the prediction confidence intervals indicated by the
colored shades around the lines. If needed, the confidence intervals can
be substituted with the standard errors of the estimates or they can be
removed completely.</p>
<p>Finaly, in order to give a more honest account of the model fit, we
can visualize the simple slopes over the plots of the actual data (<span
class="modulename">GAMLj</span> v. &gt;= 0.9.3).</p>
<p><img src="examples/glm1/resultsplot2.png" class="img-responsive" alt=""></p>
</div>
</div>
<div id="pure-r" class="section level1">
<h1>Pure R</h1>
<p>By pure R I mean using R-core with the minimum number of additional
packages. Of course, there’s always a package in R that wraps things up
for us, but here we assume we do not know of any.</p>
<p>First load the data and center the independent variables</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>dat<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">&quot;../data/exercise.csv&quot;</span>)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>dat<span class="sc">$</span>zexer<span class="ot">&lt;-</span>dat<span class="sc">$</span>zexer<span class="sc">-</span><span class="fu">mean</span>(dat<span class="sc">$</span>zexer)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>dat<span class="sc">$</span>xage<span class="ot">&lt;-</span>dat<span class="sc">$</span>xage<span class="sc">-</span><span class="fu">mean</span>(dat<span class="sc">$</span>xage)</span></code></pre></div>
<p>and then we estimate the model with the interaction between
<code>xage</code> and <code>zexer</code></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>model<span class="ot">&lt;-</span><span class="fu">lm</span>(yendu<span class="sc">~</span>xage<span class="sc">*</span>zexer,<span class="at">data=</span>dat)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>(sumr<span class="ot">&lt;-</span><span class="fu">summary</span>(model))</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = yendu ~ xage * zexer, data = dat)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -21.165  -6.939   0.269   6.300  21.299 
## 
## Coefficients:
##             Estimate Std. Error t value             Pr(&gt;|t|)    
## (Intercept) 25.88872    0.64662  40.037 &lt; 0.0000000000000002 ***
## xage        -0.26169    0.06406  -4.085       0.000060074787 ***
## zexer        0.97272    0.13653   7.124       0.000000000012 ***
## xage:zexer   0.04724    0.01359   3.476             0.000604 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 9.7 on 241 degrees of freedom
## Multiple R-squared:  0.2061, Adjusted R-squared:  0.1962 
## F-statistic: 20.86 on 3 and 241 DF,  p-value: 0.000000000004764</code></pre>
<p>If one requires the standardized solution, the same procedure can be
done after standardizing the variables</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>dat<span class="sc">$</span>zexer_z<span class="ot">&lt;-</span><span class="fu">scale</span>(dat<span class="sc">$</span>zexer)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>dat<span class="sc">$</span>xage_z<span class="ot">&lt;-</span><span class="fu">scale</span>(dat<span class="sc">$</span>xage)</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>dat<span class="sc">$</span>yendu_z<span class="ot">&lt;-</span><span class="fu">scale</span>(dat<span class="sc">$</span>yendu)</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>model_z<span class="ot">&lt;-</span><span class="fu">lm</span>(yendu_z<span class="sc">~</span>xage_z<span class="sc">*</span>zexer_z,<span class="at">data=</span>dat)</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="fu">summary</span>(model_z)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = yendu_z ~ xage_z * zexer_z, data = dat)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.95626 -0.64141  0.02486  0.58225  1.96869 
## 
## Coefficients:
##                Estimate Std. Error t value       Pr(&gt;|t|)    
## (Intercept)    -0.05933    0.05977  -0.993       0.321857    
## xage_z         -0.24446    0.05985  -4.085 0.000060074787 ***
## zexer_z         0.42933    0.06026   7.124 0.000000000012 ***
## xage_z:zexer_z  0.21075    0.06064   3.476       0.000604 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.8965 on 241 degrees of freedom
## Multiple R-squared:  0.2061, Adjusted R-squared:  0.1962 
## F-statistic: 20.86 on 3 and 241 DF,  p-value: 0.000000000004764</code></pre>
<div id="simple-slope" class="section level2">
<h2>Simple Slope</h2>
<p>Recall that in a linear model with interaction, the simple slope (the
B coefficient one gets from the model associated with the IV) is the
effect of one independent variable estimated for the other variable
equal to zero. Thus, by centering the moderator at different values, we
can obtain the slope of a variable for any value of the moderator by
centering the moderator to that value.</p>
<p>We use +- SD.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># centering zexer to +SD and -SD</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>dat<span class="sc">$</span>zexer_high<span class="ot">&lt;-</span>(dat<span class="sc">$</span>zexer)<span class="sc">-</span>(<span class="fu">mean</span>(dat<span class="sc">$</span>zexer)<span class="sc">+</span><span class="fu">sd</span>(dat<span class="sc">$</span>zexer))</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>dat<span class="sc">$</span>zexer_low<span class="ot">&lt;-</span>(dat<span class="sc">$</span>zexer)<span class="sc">-</span>(<span class="fu">mean</span>(dat<span class="sc">$</span>zexer)<span class="sc">-</span><span class="fu">sd</span>(dat<span class="sc">$</span>zexer))</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>model_zh<span class="ot">&lt;-</span><span class="fu">lm</span>(yendu<span class="sc">~</span>xage<span class="sc">*</span>zexer_high,<span class="at">data=</span>dat)</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>(sumr_zh<span class="ot">&lt;-</span><span class="fu">summary</span>(model_zh))</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = yendu ~ xage * zexer_high, data = dat)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -21.165  -6.939   0.269   6.300  21.299 
## 
## Coefficients:
##                 Estimate Std. Error t value             Pr(&gt;|t|)    
## (Intercept)     30.53366    0.90253  33.831 &lt; 0.0000000000000002 ***
## xage            -0.03609    0.09025  -0.400             0.689641    
## zexer_high       0.97272    0.13653   7.124       0.000000000012 ***
## xage:zexer_high  0.04724    0.01359   3.476             0.000604 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 9.7 on 241 degrees of freedom
## Multiple R-squared:  0.2061, Adjusted R-squared:  0.1962 
## F-statistic: 20.86 on 3 and 241 DF,  p-value: 0.000000000004764</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>model_zl<span class="ot">&lt;-</span><span class="fu">lm</span>(yendu<span class="sc">~</span>xage<span class="sc">*</span>zexer_low,<span class="at">data=</span>dat)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>(sumr_zl<span class="ot">&lt;-</span><span class="fu">summary</span>(model_zl))</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = yendu ~ xage * zexer_low, data = dat)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -21.165  -6.939   0.269   6.300  21.299 
## 
## Coefficients:
##                Estimate Std. Error t value             Pr(&gt;|t|)    
## (Intercept)    21.24379    0.93371  22.752 &lt; 0.0000000000000002 ***
## xage           -0.48729    0.09214  -5.289       0.000000276122 ***
## zexer_low       0.97272    0.13653   7.124       0.000000000012 ***
## xage:zexer_low  0.04724    0.01359   3.476             0.000604 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 9.7 on 241 degrees of freedom
## Multiple R-squared:  0.2061, Adjusted R-squared:  0.1962 
## F-statistic: 20.86 on 3 and 241 DF,  p-value: 0.000000000004764</code></pre>
<p>we can extract only the slopes we are interested in and show them in
a table.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="do">## in the summary object, the effect of age is in the second row. ##</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>mat<span class="ot">&lt;-</span><span class="fu">rbind</span>(sumr_zl<span class="sc">$</span>coefficients[<span class="dv">2</span>,],sumr<span class="sc">$</span>coefficients[<span class="dv">2</span>,],sumr_zh<span class="sc">$</span>coefficients[<span class="dv">2</span>,])</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="fu">rownames</span>(mat)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;exer at -SD&quot;</span>,<span class="st">&quot;exer at mean&quot;</span>,<span class="st">&quot;exer at +SD&quot;</span>)</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>mat</span></code></pre></div>
<pre><code>##                Estimate Std. Error   t value        Pr(&gt;|t|)
## exer at -SD  -0.4872940 0.09213609 -5.288851 0.0000002761221
## exer at mean -0.2616898 0.06406384 -4.084828 0.0000600747870
## exer at +SD  -0.0360855 0.09025369 -0.399823 0.6896410518861</code></pre>
</div>
<div id="simple-slopes-plot-1" class="section level2">
<h2>Simple slopes plot</h2>
<p><code>ggplot2</code> is required for a nice graph.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(<span class="at">x =</span> xage, <span class="at">y =</span> yendu)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">&quot;gray&quot;</span>) </span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>p<span class="ot">&lt;-</span>p<span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">color =</span><span class="st">&quot;exer -SD&quot;</span>,<span class="at">intercept =</span> sumr_zl<span class="sc">$</span>coefficients[<span class="dv">1</span>,<span class="dv">1</span>],<span class="at">slope =</span>sumr_zl<span class="sc">$</span>coefficients[<span class="dv">2</span>,<span class="dv">1</span>] ))</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>p<span class="ot">&lt;-</span>p<span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">color =</span><span class="st">&quot;exer at mean&quot;</span>,<span class="at">intercept =</span> sumr<span class="sc">$</span>coefficients[<span class="dv">1</span>,<span class="dv">1</span>],<span class="at">slope =</span>sumr<span class="sc">$</span>coefficients[<span class="dv">2</span>,<span class="dv">1</span>] ))</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>p<span class="ot">&lt;-</span>p<span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">color =</span><span class="st">&quot;exer at +SD&quot;</span>,<span class="at">intercept =</span> sumr_zh<span class="sc">$</span>coefficients[<span class="dv">1</span>,<span class="dv">1</span>],<span class="at">slope =</span>sumr_zh<span class="sc">$</span>coefficients[<span class="dv">2</span>,<span class="dv">1</span>] ))</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>p                                                                              </span></code></pre></div>
<p><img src="rosetta_moderation_files/figure-html/unnamed-chunk-6-1.png" width="768" /></p>
<p>You can embellish the plots as any ggplot graph. For example:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">library</span>(ggthemes) </span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>p<span class="sc">+</span><span class="fu">theme_tufte</span>()<span class="sc">+</span><span class="fu">geom_rangeframe</span>() </span></code></pre></div>
<p><img src="rosetta_moderation_files/figure-html/unnamed-chunk-7-1.png" width="768" /></p>
</div>
</div>
<div id="r-emmeans" class="section level1">
<h1>R emmeans</h1>
<p>In R there are many ways to obtain the same solution ( see simple <a
href="https://nickmichalak.blogspot.it/2016/07/reproducing-hayess-process-models.html">slopes
with laavan package</a> , for instance), but here I’d like to test
<code>emmeans::emtrends</code>, because it makes things so easy that it
is really worth mentioning. Furthermore, <code>emmeans</code> (the
offspring of lsmeans) is very powerfull, and does a lot of cool things,
so getting to know it is always a good idea. Details <a
href="https://cran.r-project.org/web/packages/emmeans/emmeans.pdf">here</a>.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="do">### define the levels at which we want the simple slope #####</span></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="do">### in this case, -SD, mean, -SD</span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>zlevels<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="sc">-</span><span class="fu">sd</span>(dat<span class="sc">$</span>zexer),<span class="fu">mean</span>(dat<span class="sc">$</span>zexer),<span class="sc">+</span><span class="fu">sd</span>(dat<span class="sc">$</span>zexer))</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a><span class="do">### then we run emtrends where specs is the moderator, var= the IV, and &quot;at&quot; the levels ##</span></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>emmeans<span class="sc">::</span><span class="fu">emtrends</span>(model,<span class="at">specs =</span> <span class="st">&quot;zexer&quot;</span>,<span class="at">var =</span> <span class="st">&quot;xage&quot;</span>,<span class="at">at=</span><span class="fu">list</span>(<span class="at">zexer=</span>zlevels))</span></code></pre></div>
<pre><code>##  zexer xage.trend     SE  df lower.CL upper.CL
##  -4.78    -0.4873 0.0921 241   -0.669   -0.306
##   0.00    -0.2617 0.0641 241   -0.388   -0.135
##   4.78    -0.0361 0.0903 241   -0.214    0.142
## 
## Confidence level used: 0.95</code></pre>
<p>Pretty sleek!</p>
<p>By the way, you can condition the simple slopes to any value you
want. Percentile? let’s do it:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="do">### define the levels at which we want the simple slope #####</span></span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a><span class="do">### in this case, 0, 25th, 50th, and 75th and 10oth percentile</span></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>(perc<span class="ot">&lt;-</span><span class="fu">quantile</span>(dat<span class="sc">$</span>zexer))</span></code></pre></div>
<pre><code>##          0%         25%         50%         75%        100% 
## -10.6734698  -3.6734698   0.3265302   3.3265302  15.3265302</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="do">### then we run emtrends where specs is the moderator, var= the IV, and &quot;at&quot; the levels ##</span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>emmeans<span class="sc">::</span><span class="fu">emtrends</span>(model,<span class="at">specs =</span> <span class="st">&quot;zexer&quot;</span>,<span class="at">var =</span> <span class="st">&quot;xage&quot;</span>,<span class="at">at=</span><span class="fu">list</span>(<span class="at">zexer=</span>perc))</span></code></pre></div>
<pre><code>##    zexer xage.trend     SE  df lower.CL upper.CL
##  -10.673     -0.766 0.1598 241  -1.0807  -0.4512
##   -3.673     -0.435 0.0820 241  -0.5968  -0.2736
##    0.327     -0.246 0.0641 241  -0.3726  -0.1199
##    3.327     -0.105 0.0776 241  -0.2575   0.0484
##   15.327      0.462 0.2167 241   0.0356   0.8893
## 
## Confidence level used: 0.95</code></pre>
</div>
<div id="pure-spss" class="section level1">
<h1>Pure SPSS</h1>
<p>In SPSS we can follow the same procedure we used in pure R,
estimating three models after centering the moderator at different
levels. This is easy but tediuos , so we move to a different strategy.
We can use something similar to <code>R emmeans</code> strategy, and
estimate contrasts on the (centered) model coefficients using
<code>GLM  contrasts</code> option.</p>
<p>Before estimating the model, we center the independent variables, so
we need to know their means.</p>
<p><img src="rosetta/moderation/r.spss1.png" class="img-responsive" alt=""></p>
<pre class="spss"><code>compute cexer=zexer-10.67.
compute cage=xage-49.18.
</code></pre>
<p>and use the centered variable to estimate the model</p>
<pre class="spss"><code>
GLM yendu WITH czexer cxage
  /INTERCEPT=INCLUDE
   /PRINT PARAMETER
  /DESIGN= cage cexer cage*cexer.

</code></pre>
<p>SPSS returns both the F-tests and the parameter estimates (with
t-tests and p-value). We look at the latter ones.</p>
<p><img src="rosetta/moderation/r.spss2.png" class="img-responsive" alt=""></p>
<p>Now we can play with the model for estimating contrasts on its
parameters. Recall that a simple slope for <span
class="math inline">\(x\)</span> is simple <span
class="math inline">\(B_x+ B_{xz} \cdot z_0\)</span>, for some value of
<span class="math inline">\(z_0\)</span> of the moderator. Thus, for a
centered model,the simple slope of <span
class="math inline">\(x\)</span> for <span
class="math inline">\(z=+SD\)</span> is <span class="math inline">\(B_x+
B_{xz} \cdot SD_z\)</span>, and for <span
class="math inline">\(z=-SD\)</span>, we get <span
class="math inline">\(B_x+ B_{xz} \cdot -SD_z\)</span>.</p>
<p>Estimation and testing for combinations of model parameters can be
obtained in SPSS with <code>/LMATRIX</code> subcommand.
<code>/LMATRIX</code> subcommand syntax is
<code>/LMATRIX label term1 code1 term2 code2 etc</code>. In our case,
<code>term1</code> is <code>cxage</code>, code1 is 1, term2 is the
interaction <code>cxage*czexer</code> and code2 is one SD of
<code>zexer</code>.</p>
<pre class="spss"><code>
GLM yendu WITH czexer cxage
  /INTERCEPT=INCLUDE
   /PRINT PARAMETER
   /LMATRIX =&quot;Moderator -1 SD&quot; cage 1 cage*cexer -4.77
   /LMATRIX =&quot;Moderator +1 SD&quot; cage 1 cage*cexer 4.77
   /DESIGN= cxage czexer cxage*czexer.
</code></pre>
<p>In the contrast results, we find the estimates, the confidence
intervals and the p-values. There’re also the F-test tables, which are
in line with the <span class="modulename">GAMLj</span> F-tests.</p>
<p><img src="rosetta/moderation/r.spss3.png" class="img-responsive" alt="">
<img src="rosetta/moderation/r.spss4.png" class="img-responsive" alt=""></p>
<div id="simple-slopes-plot-2" class="section level2">
<h2>Simple slopes plot</h2>
<p>To obtains a simple slope plot we need to write some numbers in the
systax. That’s a drag! The good news is that it works for any king of
model, glm, generalized, EEM, mixed, hierarchical etc. etc.</p>
<p>We build a dataset with all combinations of interesting levels (SD
and mean) of the independent variables.</p>
<pre class="spss"><code>
ORTHOPLAN /FACTORS=x (10 0 10) z (-4 0 4) /REPLACE.
</code></pre>
<p><img src="rosetta/moderation/r.spss5.png" class="img-responsive" alt=""></p>
<p>then compute the expected values using the centered model
coefficients.</p>
<pre class="spss"><code>
compute a=25.86.
compute bx=-.262.
compute bz=.973.
compute bint=.047.
compute y=a+bx*x+bz*z+bint*x*z.</code></pre>
<p>An then we plot the variable. Plotting can be done using standard
plots and tweak the graph manually.</p>
<pre><code>GRAPH
  /SCATTERPLOT(BIVAR)=x WITH y BY z.
</code></pre>
<p><img src="rosetta/moderation/r.spss6.png" class="img-responsive" alt=""></p>
<p>You can manually change the plot, but it will come back ugly when you
re-run it. To get nice graphical results without manual intevention you
can use SPSS GGRAPH with GPL (not explained here) and get something like
this.</p>
<pre class="spss"><code>
string mod(a10).
recode z (-4=&quot;-1 DS&quot; ) (0=&quot;Mean&quot;) ( 4=&quot;+1 DS&quot;) into mod.
execute.
GGRAPH 
  /GRAPHDATASET  NAME=&quot;Data&quot; VARIABLES =ALL
   /GRAPHSPEC SOURCE=INLINE .
BEGIN GPL
SOURCE: s=userSource( id( &quot;Data&quot; ) ) 
DATA: x=col( source(s), name( &quot;x&quot; ) )
DATA: y=col( source(s), name( &quot;y&quot; ) )
DATA: mod=col( source(s), name( &quot;mod&quot; ) , unit.category())
GUIDE: legend(aesthetic(aesthetic.shape), label(&quot;Exercise&quot;))
GUIDE: legend(aesthetic(aesthetic.color), label(&quot;Exercise&quot;))
SCALE: cat(aesthetic(aesthetic.shape), map((&quot;-1 DS&quot;,shape.dash_2x),(&quot;Media&quot;,shape.solid),(&quot;+1 DS&quot;,shape.half_dash))) 
SCALE: cat(aesthetic(aesthetic.color), map((&quot;+1 DS&quot;,color.black),(&quot;Media&quot;,color.grey),(&quot;-1 DS&quot;,color.lightslategray))) 
GUIDE: axis(dim(1), label(&quot;Age&quot;))
GUIDE: axis(dim(2), label(&quot;Endurance&quot;))
ELEMENT: line( position(smooth.linear(x*y)),shape(mod),color(mod),size(size.&quot;5px&quot;)) 
END GPL.</code></pre>
<p><img src="rosetta/moderation/r.spss7.png" class="img-responsive" alt=""></p>
</div>
</div>
<div id="spss-process" class="section level1">
<h1>SPSS PROCESS</h1>
<p>PROCESS is an add-on for SPSS that simplifies computation of simple
slopes and does many more things (expecially mediation and moderated
mediation). It is very well documented <a
href="http://www.processmacro.org/index.html">here</a>.</p>
<p>In order to check if the previous results are in line with PROCESS,
we estimated the model again as follows:</p>
<p><img src="rosetta/moderation/process1.png" class="img-responsive" alt=""></p>
<p>and get the simple slopes we needed</p>
<p><img src="rosetta/moderation/r.process1.png" class="img-responsive" alt=""></p>
<p>Please notice that we estimated the centered model for the sake of
comparability, but in PROCESS you do not need to center the variables
because the macro will center them for you. PROCESS produces also the
syntax for plotting the simple slopes, using the strategies we used in
<em>pure SPSS</em> section.</p>
</div>
<div id="comments" class="section level1 adm adm-warning">
<h1>Comments?</h1>
<p>
Got comments, issues or spotted a bug? Please open an issue on
<a href="https://github.com/gamlj/gamlj//issues " target="_blank"> GAMLj
at github</a> or <a href="mailto:mcfanda@gmail.com

">send me an email</a>
</p>
</div>
</div>

   
   
            
      

  <script>
    $(document).ready(function () {

			
 		
		$('#content img:not(.no-lightbox)').addClass("image-lb");
	$('#content').magnificPopup({
	    type:'image',
	    closeOnContentClick: false,
	    closeBtnInside: false,
	    delegate: '.image-lb',
	    gallery: {enabled: false },
	    image: {
	        verticalFit: true,
		titleSrc: 'alt'
	    }
 	});
 	    });
  </script>



    <!-- dynamically load mathjax for compatibility with self-contained -->
  <script>
    (function () {
	var script = document.createElement("script");
	script.type = "text/javascript";
	script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
	document.getElementsByTagName("head")[0].appendChild(script);
    })();
  </script>
  
</body>
</html>
