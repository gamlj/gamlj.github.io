<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="generator" content="pandoc" />

    
    
    <title>Mixed Models module technical details</title>

        <script src="site_libs/header-attrs-2.29/header-attrs.js"></script>
        <script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link href="site_libs/bootstrap-3.3.7/css/bootstrap.min.css" rel="stylesheet" />
        <script src="site_libs/bootstrap-3.3.7/js/bootstrap.min.js"></script>
        <script src="site_libs/navigation-1.1/tabsets.js"></script>
        <link href="site_libs/magnific-popup-1.1.0/magnific-popup.css" rel="stylesheet" />
        <script src="site_libs/magnific-popup-1.1.0/jquery.magnific-popup.min.js"></script>
        <link href="site_libs/readthedown-0.1/readthedown.css" rel="stylesheet" />
        <link href="site_libs/readthedown-0.1/readthedown_fonts_embed.css" rel="stylesheet" />
        <script src="site_libs/readthedown-0.1/readthedown.js"></script>
        <script>
        $(document).ready(function () {

            if ($(".root")[0]){
              return
            };
            $('.navbar-toggle').show();
            $('.navbar').css('display', 'none');
            $('#sidebar > h2 ').append("<a id='navbut' href=''><i class='fa fa-bars'></i></a>");
            $('#navbut').on( "click", function(e) {
                       $('.navbar').toggle();
                       e.preventDefault();
               } );
              $('.navbar-toggle').on('click', function(e) {
                       $('.navbar').toggle();
                       e.preventDefault();
              });       
            $(window).scroll(function (event) {
                $('.navbar').css('display', 'none');
            });       
        });
        </script>
        <!-- Google tag (gtag.js) -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-KM7X6HK5HM"></script>
        <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());

          gtag('config', 'G-KM7X6HK5HM');
        </script>
    
    
    
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css" type="text/css" />
        <link rel="stylesheet" href="mcdocs.css" type="text/css" />
        <link rel="stylesheet" href="down.css" type="text/css" />
    
    <!-- tabsets -->
    <script>
      $(document).ready(function () {
	  window.buildTabsets("toc");
      });
      $(document).ready(function () {
	  $('.tabset-dropdown > .nav-tabs > li').click(function () {
	      $(this).parent().toggleClass('nav-tabs-open')
	  });
      });
    </script>

    <!-- code folding -->
    
    <!-- code download -->
    
    <!-- tabsets dropdown -->

    <style type="text/css">
      .tabset-dropdown > .nav-tabs {
	  display: inline-table;
	  max-height: 500px;
	  min-height: 44px;
	  overflow-y: auto;
	  background: white;
	  border: 1px solid #ddd;
	  border-radius: 4px;
      }
      
      .tabset-dropdown > .nav-tabs > li.active:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
	  content: "&#xe258;";
	  border: none;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .tabset-dropdown > .nav-tabs > li.active {
	  display: block;
      }

      .tabset-dropdown > .nav-tabs > li.active a {
  	  padding: 0 15px !important;
      }

      .tabset-dropdown > .nav-tabs > li > a,
      .tabset-dropdown > .nav-tabs > li > a:focus,
      .tabset-dropdown > .nav-tabs > li > a:hover {
	  border: none;
	  display: inline-block;
	  border-radius: 4px;
	  background-color: transparent;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li {
	  display: block;
	  float: none;
      }
      
      .tabset-dropdown > .nav-tabs > li {
	  display: none;
	  margin-left: 0 !important;
      }
    </style>
    
</head>

<body class="preload">

   	
         <!-- readthedown start -->   
   <div id="content" data-toggle="wy-nav-shift">
     <nav id="nav-top" role="navigation" aria-label="top navigation">
       <a role="button" href="#" data-toggle="wy-nav-top"><span class="glyphicon glyphicon-menu-hamburger"></span></a>
     </nav>
         
   
      
      <div class="navbar navbar-default  navbar-fixed-top" role="navigation">
        <div class="container">
          <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="index.html">GAMLj</a>
          </div>
          <div id="navbar" class="navbar-collapse collapse">
            <ul class="nav navbar-nav">
              <li>
        <a href="glm.html">GLM</a>
      </li>
      <li>
        <a href="mixed.html">Mixed</a>
      </li>
      <li>
        <a href="gzlm.html">Generalized</a>
      </li>
      <li>
        <a href="gzlmmixed.html">Generalized Mixed</a>
      </li>
      <li>
        <a href="examples.html">Examples</a>
      </li>
      <li>
        <a href="release_notes.html">Release notes</a>
      </li>
      <li>
        <a href="vignettes.html">GAMLj in R</a>
      </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
              <li>
        <a href="https://github.com/gamlj/gamlj">View on Github</a>
      </li>
            </ul>
          </div><!--/.nav-collapse -->
        </div><!--/.container -->
      </div><!--/.navbar -->
        
      <h1 class="title">Mixed Models module technical details</h1>
      
         <!-- readthedown authors -->
   <div id="sidebar">
    <h2><a href="#content">Mixed Models module technical
details</a></h2>
    <div id="toc">
      <ul>
      <li><a href="#degrees-of-freedom"
      id="toc-degrees-of-freedom">Degrees of freedom</a></li>
      <li><a href="#post-hocs" id="toc-post-hocs">Post Hocs</a></li>
      <li><a href="#optimizer" id="toc-optimizer">Optimizer</a></li>
      </ul>
    </div>
    <div id="postamble" data-toggle="wy-nav-shift" class="status">
                </div>
   </div>
     

   
      
   
<!-- Don't indent these lines or it will mess pre blocks indentation --> 
<div id="main">
<div id="degrees-of-freedom" class="section level1">
<h1>Degrees of freedom</h1>
<p>As far as it is possible, inferential tests are based on an automatic
selection of the degrees of freedom for the t-tests and the F-tests.</p>
<ul>
<li><p>For the t-tests the module relies on the Satterthwaite
approximation of degrees of freedom as it is implemented by the <a
href="https://cran.r-project.org/web/packages/lmerTest/index.html">lmerTest
package</a>. <code>Lmertest::summary()</code> produces t-test DF and
p-values in the majority of cases. When the model does not converge, or
some problem with the model occurs, the DF cannot be estimated and thus
the p-values are not reported in the parameter estimates table. A
warning note is displayed in those cases. See details in <a
href="https://cran.r-project.org/web/packages/lmerTest/index.html">lmerTest
package</a>.</p></li>
<li><p>For the F-tests of the main model (“Fixed Effects ANOVA”), the
module relies again on the Satterthwaite approximation of degrees of
freedom as it is implemented by the <a
href="https://cran.r-project.org/web/packages/lmerTest/index.html">lmerTest
package</a>. <code>Lmertest::anova()</code> has difficulties in
calculating F-test DF and p-values when the model does not converge,
there are problems with the model random variances, or when numerical
independent variables appear in complex interactions. When the
<code>lmerTest::anova()</code> does not produce the DF and p-values, the
module switches to <code>car::Anova(..,type=3, test="F")</code> function
of the R <a
href="https://cran.r-project.org/web/packages/car/index.html">car
package</a>. <code>car::Anova(..,type=3, test="F")</code> implements the
Kenward-Roger method for degrees of freedom. A warning note is displayed
in those cases.</p></li>
<li><p>For F-tests of simple effects, the
<code>car::Anova(..,type=3, test="F")</code> is always used, thus the
the Kenward-Roger method for degrees of freedom is employed. This is
because the <code>lmertest::anova()</code> requires the factor contrast
to be <code>contr.sum()</code>, which does not allow to estimate simple
effects. <code>car::Anova(..,type=3, test="F")</code> has not such a
limitations, so it works fine for the purpose.</p></li>
</ul>
</div>
<div id="post-hocs" class="section level1">
<h1>Post Hocs</h1>
<p>Post-hocs tests are performed as implemented in the <a
href="https://cran.r-project.org/web/packages/emmeans/index.html">emmeans
package</a>. In particular, the actual implementation is as follows (for
any given model term selected by the user) :</p>
<pre><code>      formula &lt;- as.formula(paste(&#39;~&#39;, term))
      referenceGrid &lt;- emmeans::emmeans(private$.model, formula)
      bonferroni &lt;- summary(pairs(referenceGrid, adjust=&#39;bonferroni&#39;))
      holm &lt;- summary(pairs(referenceGrid, adjust=&#39;holm&#39;))
      tukey&lt;-summary(pairs(referenceGrid, adjust=&#39;tukey&#39;))
      scheffe&lt;-summary(pairs(referenceGrid, adjust=&#39;scheffe&#39;))
      sidak&lt;-summary(pairs(referenceGrid, adjust=&#39;sidak&#39;))

      </code></pre>
</div>
<div id="optimizer" class="section level1">
<h1>Optimizer</h1>
<p>Estimating a mixed model requires to minimize several quantities and
to refine the numerical solution is several ways. These operations are
based on an algorithm that optimize the minimization. Different
algorithms are available in R package <code>lme4</code> provides
different algorithms, among which the <code>bobyqa</code>, the
<code>Nelder_Mead</code> and the <code>nloptwrap</code> algorithm <a
href="https://cran.r-project.org/web/packages/lme4/vignettes/lmerperf.html">see
lme4 vignettes</a>. <span class="modulename">GAMLj</span> automatically
starts the estimation using the <code>bobyqa</code> algorithm. If the
model does not converge, it move to <code>Nelder_Mead</code>, and, upon
a new failure, tries <code>nloptwrap</code>. If none converges, the
first estimation is provided and a warning is issued.</p>
<div class="adm adm-seealso backto">
<p>
Return to main help pages
</p>
<a class='backto' href='index.html'>Main page</a>
<a class="backto" href="./mixed.html">Mixed Models</a>
<a class="backto" href="./gzlmmixed.html">Generalized Mixed Models</a>
</div>
</div>
</div>

   
   
            
      

  <script>
    $(document).ready(function () {

			
 		
		$('#content img:not(.no-lightbox)').addClass("image-lb");
	$('#content').magnificPopup({
	    type:'image',
	    closeOnContentClick: false,
	    closeBtnInside: false,
	    delegate: '.image-lb',
	    gallery: {enabled: false },
	    image: {
	        verticalFit: true,
		titleSrc: 'alt'
	    }
 	});
 	    });
  </script>



    <!-- dynamically load mathjax for compatibility with self-contained -->
  <script>
    (function () {
	var script = document.createElement("script");
	script.type = "text/javascript";
	script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
	document.getElementsByTagName("head")[0].appendChild(script);
    })();
  </script>
  
</body>
</html>
