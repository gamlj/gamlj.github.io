<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>GAMLj Models</title>
  <meta name="description" content="Examples of using GAMLj jamovi module to estimates different types of linear models" />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="GAMLj Models" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Examples of using GAMLj jamovi module to estimates different types of linear models" />
  <meta name="github-repo" content="mcfanda/gamlj.github.io" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="GAMLj Models" />
  
  <meta name="twitter:description" content="Examples of using GAMLj jamovi module to estimates different types of linear models" />
  

<meta name="author" content="Marcello Gallucci" />


<meta name="date" content="2023-01-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  


<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-KM7X6HK5HM"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-KM7X6HK5HM');
</script>



<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" href="mcstyle.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">GAMLj Models</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path=""><a href="#gmixed"><i class="fa fa-check"></i><b>1</b> Generalized Mixed Linear Models</a>
<ul>
<li class="chapter" data-level="1.1" data-path=""><a href="#introduction"><i class="fa fa-check"></i><b>1.1</b> Introduction</a></li>
<li class="chapter" data-level="1.2" data-path=""><a href="#examples"><i class="fa fa-check"></i><b>1.2</b> Examples</a></li>
<li class="chapter" data-level="1.3" data-path=""><a href="#mixed-logistic-model"><i class="fa fa-check"></i><b>1.3</b> Mixed logistic model</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path=""><a href="#model-estimation"><i class="fa fa-check"></i><b>1.3.1</b> Model Estimation</a></li>
<li class="chapter" data-level="1.3.2" data-path=""><a href="#model-info"><i class="fa fa-check"></i><b>1.3.2</b> Model Info</a></li>
<li class="chapter" data-level="1.3.3" data-path=""><a href="#model-fit"><i class="fa fa-check"></i><b>1.3.3</b> Model Fit</a></li>
<li class="chapter" data-level="1.3.4" data-path=""><a href="#random-component"><i class="fa fa-check"></i><b>1.3.4</b> Random Component</a></li>
<li class="chapter" data-level="1.3.5" data-path=""><a href="#coefficients"><i class="fa fa-check"></i><b>1.3.5</b> Coefficients</a></li>
<li class="chapter" data-level="1.3.6" data-path=""><a href="#plot"><i class="fa fa-check"></i><b>1.3.6</b> Plot</a></li>
<li class="chapter" data-level="1.3.7" data-path=""><a href="#other-options-and-techniques"><i class="fa fa-check"></i><b>1.3.7</b> Other options and techniques</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path=""><a href="#other-model-charateristics"><i class="fa fa-check"></i><b>1.4</b> Other model charateristics</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path=""><a href="#multinomial-mixed-model"><i class="fa fa-check"></i><b>1.4.1</b> Multinomial mixed model</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">GAMLj Models</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="header">
<h1 class="title">GAMLj Models</h1>
<p class="author"><em>Marcello Gallucci</em></p>
<p class="date"><em>2023</em></p>
</div>
<div id="gmixed" class="section level1 hasAnchor" number="1">
<h1><span class="header-section-number">Chapter 1</span> Generalized Mixed Linear Models<a href="#gmixed" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><span class="draft"> Draft version, mistakes may be around </span></p>
<p><span class="keywords"> <span class="keytitle"> keywords </span> Generalized Linear Model, Logistic Regression, logit, Mixed Model, Multilevel Models </span></p>
<div id="introduction" class="section level2 hasAnchor" number="1.1">
<h2><span class="header-section-number">1.1</span> Introduction<a href="#introduction" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The generalized linear model (cf. Chapter <a href="#gzlm"><strong>??</strong></a>) is very convenient in analyzing models with categorical and non-normally distributed variables. The Mixed model (cf. Chapter <a href="#mixed"><strong>??</strong></a>) is useful to tackle designs with multilevel sampling, where units can be correlated due to the clustering of data. The <em>Generalized Mixed Linear Models</em> (GZMM) allow us to predict categorical and non-normally distributed variables when data are clustered and dependent.</p>
<p>From a theoretical point of view, we do not need to add much to what we have seen in the previous chapter. The setup of the GZMM is carried out exactly as it is done for the Mixed Model (cf. Section <a href="#mixedbuild"><strong>??</strong></a>). The choice of the particular application of the generalized model is carried out exactly as it is done for the generalized linear model (cf. Chapter <a href="#gzlm"><strong>??</strong></a>). Thus, we can estimate logistic, ordinal, multinomial, Poisson and negative binomial models when the data are clustered, in repeated-measure designs or in multilevel sampling designs.</p>
<p>Thus, we are not going to repeat the specific characteristics of each model, because they have been discussed in the previous chapters. We highlight the noticeable features that characterize each application of the generalized linear model with random coefficients and clustered data.</p>
<div class="enf">
<p>For the remainder of this chapter, we will not cover all the possible models provided by r modulename() in the generalized mixed model. This is because, when setting up the models, one can refer to the mixed model (r cap(“gzlm”)), and when interpreting the results, one can refer to the generalized linear model (r cap(“gzlm”)). HHowever, we will explore an example using the logistic mixed model and subsequently highlight certain features of other models that may yield unexpected results.</p>
</div>
</div>
<div id="examples" class="section level2 hasAnchor" number="1.2">
<h2><span class="header-section-number">1.2</span> Examples<a href="#examples" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For all the examples, we will utilize the ‘clusteredmanymodels’ dataset available in the r jamovi library. To add some appeal to the example, we will incorporate the same cover stories employed in the generalized linear model . Regarding the mixed model (see r sec(“mixeddata”)), we envision the data being collected by sampling a set of bars and, within each bar, sampling the customers.</p>
</div>
<div id="mixed-logistic-model" class="section level2 hasAnchor" number="1.3">
<h2><span class="header-section-number">1.3</span> Mixed logistic model<a href="#mixed-logistic-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The logistic model predicts a dichotomous variable by estimating the logit of belonging to one group instead of the other. This involves predicting the logarithm of the odds of belonging to that particular group rather than the other (refer to Section <a href="#logistic"><strong>??</strong></a> for more information). In the <code>clusteredmanymodels</code> dataset, we have a dichotomous dependent variable called <code>ybin</code> that includes two groups. In the cover story, <code>ybin</code> indicates whether the participant visited the restroom, with <code>1=YES</code> and <code>0=NO</code> (cf. Section <a href="#logisticestim"><strong>??</strong></a>). So we use a <em>Generalized Linear Mixed Model</em>.</p>
<p>We have a dichotomous variable that we want to predict using a continuous variable (<span class="math inline">\(x\)</span> for beers). However, it is important to consider that the data are not independent units drawn from a random sample. Instead, they are clustered due to bars (variable <code>cluster</code>).</p>
<div id="model-estimation" class="section level3 hasAnchor" number="1.3.1">
<h3><span class="header-section-number">1.3.1</span> Model Estimation<a href="#model-estimation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>First, we open the analysis by selecting <span class="option">Generalized Mixed Models</span> in the <span class="option">Linear Models</span> menu. Then, we select the <code>Logistic</code> model in the upper side of the input panel.</p>
<div style="text-align:center">
<p><img src="bookletpics/5_logistic_input1.png" width="80%" /></p>
</div>
<p>Then, we can set the variables in their variable role field, as we did for any other model.</p>
<div style="text-align:center">
<p><img src="bookletpics/5_logistic_input2.png" width="80%" /></p>
</div>
<p>The fixed effects are automatically included in the model, so our focus should be on the random effects. Building upon the reasoning discussed in r sec(“mixedbuild”), we can designate both the intercept and the effect of <span class="math inline">\(x\)</span> as random coefficients. Since both coefficients can be estimated within each cluster, they have the potential to vary across clusters.</p>
<div style="text-align:center">
<p><img src="bookletpics/5_logistic_input3.png" width="80%" /></p>
</div>
</div>
<div id="model-info" class="section level3 hasAnchor" number="1.3.2">
<h3><span class="header-section-number">1.3.2</span> Model Info<a href="#model-info" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The usual recap table is produced and filled as soon as we set the random component of the model. Here we find the type of information required to interpret the logistic regression (cf. Section <a href="#logisticrecap"><strong>??</strong></a>).
<span class="incomplete"> Incomplete version, please wait for updates </span></p>
<div style="text-align:center">
<p><img src="bookletpics/5_logistic_output1.png" width="80%" /></p>
</div>
<p>We want to be sure that the direction of the effects are clear, so we check in the <code>Direction</code> row that we are predicting belonging to group 1 over group 0.</p>
</div>
<div id="model-fit" class="section level3 hasAnchor" number="1.3.3">
<h3><span class="header-section-number">1.3.3</span> Model Fit<a href="#model-fit" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div style="text-align:center">
<p><img src="bookletpics/5_logistic_output2.png" width="60%" /></p>
</div>
<p>Similar to the linear mixed model, in the current context, we have two indices of goodness of fit. Since we are dealing with a generalized linear model, the fit can be understood as the reduction in error or deviance attributable to the effects included in our model. The conditional <span class="math inline">\(R^2\)</span> provides an assessment of the overall fit, encompassing both fixed and random effects. The marginal <span class="math inline">\(R^2\)</span> informs us about the fit contributed solely by the fixed effects of the model.</p>
<p>The inferential tests are based on the likelihood-ratio test (<a href='https://en.wikipedia.org/wiki/Likelihood-ratio_test' target='_blank'>LRT,</a>): For the conditional <span class="math inline">\(R^2\)</span>, the whole model is compared with a logistic model with only the intercept as parameter. So it tests all parameters of the model, fixed and random together. For the marginal <span class="math inline">\(R^2\)</span>, the whole model is compared with a logistic model with a fixed intercept and the same random coefficients of the model, so the fixed effects are tested.</p>
</div>
<div id="random-component" class="section level3 hasAnchor" number="1.3.4">
<h3><span class="header-section-number">1.3.4</span> Random Component<a href="#random-component" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div style="text-align:center">
<p><img src="bookletpics/5_logistic_output3.png" width="80%" /></p>
</div>
<p>In this analysis, our objective is to verify the accuracy of our estimated random structure, ensuring that each coefficient exhibits variance without encountering collinearity issues among them. In our specific example, we observe some variance for the intercepts (<span class="math inline">\(\sigma^2 = 0.161\)</span>), but a negligible variance for the random coefficients associated with <span class="math inline">\(x\)</span>. This suggests that the random coefficients of <span class="math inline">\(x\)</span> do not make a substantial contribution to the model’s fit, implying that they can potentially be excluded from the random component. Furthermore, the correlation between the <span class="math inline">\(x\)</span> coefficients and the intercepts across clusters indicate that the <span class="math inline">\(x\)</span> coefficients are redundant, because they correlate -1 with the intercepts, so they do not bring any additional fit to the model.</p>
<p>If the user needs to test these variances against zero, the LRT tests are available as well (cf Section <a href="#mixedre"><strong>??</strong></a>).</p>
<div style="text-align:center">
<p><img src="bookletpics/5_logistic_output5.png" width="70%" /></p>
</div>
<p>As expected, the tiny variance of the <span class="math inline">\(x\)</span> coefficients does not appear to be statistically different from zero.</p>
</div>
<div id="coefficients" class="section level3 hasAnchor" number="1.3.5">
<h3><span class="header-section-number">1.3.5</span> Coefficients<a href="#coefficients" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div style="text-align:center">
<p><img src="bookletpics/5_logistic_output4.png" width="80%" /></p>
</div>
<p>The model fixed effects can be interpreted as in a standard logistic regression. On average across <em>bars</em> (clusters), for the average number of <em>beers</em> drunk (<span class="math inline">\(x\)</span>) the expected odd of visiting the restroom is <span class="math inline">\(exp(B)=1.309\)</span>. As we increases <em>beers</em> (<span class="math inline">\(x\)</span>) of one unit, the odd of visiting the restroom increases of <span class="math inline">\(exp(B)=.954\)</span>, it diminishes <a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>.</p>
</div>
<div id="plot" class="section level3 hasAnchor" number="1.3.6">
<h3><span class="header-section-number">1.3.6</span> Plot<a href="#plot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A plot of the predicted probability as a function of the independent variable is always a good way to have a clear picture of the relationship between the dependent and the independent variable. Since we are dealing with a mixed model, it instructive to ask for the <code>random effects</code> as well, so we can say the full model predicted values. Each gray line depicts the estimated values for a specific cluster, and the solid black like the fixed effect.</p>
<div style="text-align:center">
<p><img src="bookletpics/5_logistic_plot1.png" width="80%" /></p>
</div>
</div>
<div id="other-options-and-techniques" class="section level3 hasAnchor" number="1.3.7">
<h3><span class="header-section-number">1.3.7</span> Other options and techniques<a href="#other-options-and-techniques" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>All other options available in the logistic generalized mixed model operate similarly to those in the generalized model or the mixed model. However, it is important to note that the r opt(“Bootstrap”) option, although functional, can be extremely time-consuming for this type of model. Therefore, it is advisable to be prepared for a potentially lengthy wait if utilizing this option.</p>
</div>
</div>
<div id="other-model-charateristics" class="section level2 hasAnchor" number="1.4">
<h2><span class="header-section-number">1.4</span> Other model charateristics<a href="#other-model-charateristics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As mentioned, all other model within the generalized mixed model can be estimated and interpreted based on the material of the previous chapters. When setting up the models, one can refer to the mixed model (Chapter <a href="#gzlm"><strong>??</strong></a>), and when interpreting the results, one can refer to the generalized linear model (Chapter <a href="#gzlm"><strong>??</strong></a>).</p>
<p>A few notes are nonetheless interesting to mention.</p>
<div id="multinomial-mixed-model" class="section level3 hasAnchor" number="1.4.1">
<h3><span class="header-section-number">1.4.1</span> Multinomial mixed model<a href="#multinomial-mixed-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The multinomial model is undoubtedly the strangest of the linear models discussed in this book, and its mixed version is no exception. The set up poses no challenge, but in the results section one finds a different way to report the random coefficients variances.</p>
<p>Let’s use the <code>clusteredmanymodels</code> dataset to predict the dependent variable ycat, which consists of three groups, using a continuous independent variable, denoted as <span class="math inline">\(x\)</span>. Similar to the generalized multinomial model (Section <a href="#multinomial"><strong>??</strong></a>), the model estimates <span class="math inline">\(K-1\)</span> logistic regressions, where <span class="math inline">\(K\)</span> represents the number of groups or levels within the dependent variable. Each regression corresponds to a dummy variable required to incorporate the categorical dependent variable into the model. Consequently, the model comprises <span class="math inline">\(K-1\)</span> intercepts and <span class="math inline">\(K-1\)</span> effects of the independent variable.</p>
<div class="enf">
<p>If we set the intercepts as random coefficients, we will obtain a table displaying the variances and covariances among all the random intercepts. On the other hand, if we set both intercepts and slopes as random coefficients, we will obtain a table encompassing the variances and covariances of all the intercepts and slopes.</p>
</div>
<p>Let’s see an example. The fixed effects are set as this:</p>
<div style="text-align:center">
<p><img src="bookletpics/5_multinomial_input1.png" width="70%" /></p>
</div>
<p>The random effects are set as this:</p>
<div style="text-align:center">
<p><img src="bookletpics/5_multinomial_input2.png" width="70%" /></p>
</div>
<p>Fixed effects results are:</p>
<div style="text-align:center">
<p><img src="bookletpics/5_multinomial_output1.png" width="90%" /></p>
</div>
<p>and the random coefficients variances and covariances are:</p>
<div style="text-align:center">
<p><img src="bookletpics/5_multinomial_output2.png" width="50%" /></p>
</div>
<p>For each random coefficient, its variance is located on the diagonal of the random variance-covariance matrix, while the covariances are found in the off-diagonal cells. To provide more specific details, the 2~1 represents the intercept of the logistic regression model predicting the dummy variable for level 2 vs level 1. Similarly, the 3~1 corresponds to the intercept of the logistic regression model predicting the dummy variable for level 3 vs level 1, and so forth. The coefficient x~2 represents the random coefficient associated with the variable x predicting the first dummy, x~3 is the coefficient predicting the second dummy. Thus, the first diagonal value denotes the variance of the first logistic intercept, the second diagonal value signifies the variance of the second logistic intercept, and so on.</p>
<p><span class="incomplete"> Incomplete version, please wait for updates </span></p>
</div>
</div>
</div>






<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>Here the cover story does not hold. Despites that, what is important is to get that the interpretation of the coefficients is in line with the results<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>


    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": false,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
